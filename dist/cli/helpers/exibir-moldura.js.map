{"version":3,"file":"exibir-moldura.js","sourceRoot":"","sources":["../../../src/cli/helpers/exibir-moldura.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n/**\n * Helper para exibição segura de molduras (blocos formatados)\n * Fornece fallback para ambientes onde log.bloco não está disponível\n */\n\nimport { CliExibirMolduraMessages } from '@core/messages/cli/cli-exibir-moldura-messages.js';\nimport { log } from '@core/messages/index.js';\n\n/**\n * Exibe uma moldura formatada com fallback seguro\n *\n * Tenta usar log.bloco para exibir uma moldura estilizada.\n * Se falhar (ambiente de teste ou log.bloco não disponível),\n * usa fallback simples com log.info.\n *\n * @param titulo - Título da moldura\n * @param linhas - Linhas de conteúdo a exibir\n * @param fallbackFn - Função de fallback customizada (opcional)\n * @returns true se usou moldura, false se usou fallback\n *\n * @example\n * ```typescript\n * exibirMolduraSegura('Plano de reestruturação', [\n *   'De                  → Para',\n *   '-------------------  -------------------',\n *   'src/old.ts          → src/new.ts',\n * ]);\n * ```\n */\nexport function exibirMolduraSegura(\n  titulo: string,\n  linhas: string[],\n  fallbackFn?: () => void,\n): boolean {\n  try {\n    // Tenta usar log.bloco (disponível em produção)\n    const bloco = (\n      log as unknown as { bloco: (t: string, l: string[]) => string }\n    ).bloco(titulo, linhas);\n    console.log(bloco);\n    return true;\n  } catch {\n    // Fallback: usa função customizada ou exibição simples\n    if (fallbackFn) {\n      fallbackFn();\n    } else {\n      // Fallback padrão: exibe linhas simples com log.info\n      linhas.forEach((linha) =>\n        log.info(CliExibirMolduraMessages.fallbackLinha(linha)),\n      );\n    }\n    return false;\n  }\n}\n\n/**\n * Exibe moldura de plano de reestruturação com tratamento de overflow\n *\n * @param movimentos - Lista de movimentos (formato: { de, para })\n * @param limite - Número máximo de linhas a exibir (padrão: 10)\n */\nexport function exibirMolduraPlano(\n  movimentos: Array<{ de: string; para: string }>,\n  limite = 10,\n): void {\n  const linhas: string[] = [\n    CliExibirMolduraMessages.planoCabecalhoLinha1,\n    CliExibirMolduraMessages.planoCabecalhoLinha2,\n  ];\n\n  const primeiros = movimentos.slice(0, limite);\n  for (const m of primeiros) {\n    const de = String(m.de).replace(/\\\\/g, '/').slice(0, 34).padEnd(34, ' ');\n    const para = String(m.para).replace(/\\\\/g, '/').slice(0, 39);\n    linhas.push(`${de}  → ${para}`);\n  }\n\n  if (movimentos.length > limite) {\n    linhas.push(\n      CliExibirMolduraMessages.planoOverflow(movimentos.length - limite),\n    );\n  }\n\n  exibirMolduraSegura(CliExibirMolduraMessages.planoTitulo, linhas, () => {\n    primeiros.forEach((m) =>\n      log.info(CliExibirMolduraMessages.planoFallbackLinha(m.de, m.para)),\n    );\n    if (movimentos.length > limite) {\n      log.info(\n        CliExibirMolduraMessages.planoFallbackOverflow(\n          movimentos.length - limite,\n        ),\n      );\n    }\n  });\n}\n\n/**\n * Exibe moldura de conflitos com tratamento de overflow\n *\n * @param conflitos - Lista de conflitos (formato: { alvo, motivo })\n * @param limite - Número máximo de linhas a exibir (padrão: 10)\n */\nexport function exibirMolduraConflitos(\n  conflitos: Array<{ alvo?: string; motivo?: string } | unknown>,\n  limite = 10,\n): void {\n  const linhas: string[] = [\n    CliExibirMolduraMessages.conflitosCabecalhoLinha1,\n    CliExibirMolduraMessages.conflitosCabecalhoLinha2,\n  ];\n\n  const primeiros = conflitos.slice(0, limite);\n  for (const c of primeiros) {\n    const alvo = String(\n      (c && typeof c === 'object' && 'alvo' in c && c.alvo) ??\n        JSON.stringify(c),\n    )\n      .replace(/\\\\/g, '/')\n      .slice(0, 31)\n      .padEnd(31, ' ');\n    const motivo = String(\n      (c && typeof c === 'object' && 'motivo' in c && c.motivo) ?? '-',\n    ).slice(0, 30);\n    linhas.push(`${alvo}   ${motivo}`);\n  }\n\n  if (conflitos.length > limite) {\n    linhas.push(\n      CliExibirMolduraMessages.conflitosOverflow(conflitos.length - limite),\n    );\n  }\n\n  exibirMolduraSegura(CliExibirMolduraMessages.conflitosTitulo, linhas, () => {\n    primeiros.forEach((c) => {\n      const alvoStr =\n        (c && typeof c === 'object' && 'alvo' in c && c.alvo) ??\n        'alvo desconhecido';\n      const motivoStr =\n        (c && typeof c === 'object' && 'motivo' in c && c.motivo) ?? '-';\n      log.aviso(\n        CliExibirMolduraMessages.conflitosFallbackLinha(\n          String(alvoStr),\n          String(motivoStr),\n        ),\n      );\n    });\n    if (conflitos.length > limite) {\n      log.aviso(\n        CliExibirMolduraMessages.conflitosFallbackOverflow(\n          conflitos.length - limite,\n        ),\n      );\n    }\n  });\n}\n"]}