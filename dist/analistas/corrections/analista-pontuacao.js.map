{"version":3,"file":"analista-pontuacao.js","sourceRoot":"","sources":["../../../src/analistas/corrections/analista-pontuacao.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\nimport type { NodePath } from '/traverse';\nimport type { Node } from '/types';\nimport {\n  findQuickFixes,\n  type PatternBasedQuickFix,\n} from '/config/auto/fix-config.js';\n\nimport type {\n  Analista,\n  ConfiguracaoPontuacaoZelador,\n  IntlComDisplayNames,\n  Ocorrencia,\n  ProblemaPontuacao,\n} from '@';\nimport { criarOcorrencia } from '@';\n\n  /* -------------------------- Helpers / Config -------------------------- */\n\n// Constantes de limites e valores de threshold\nconst ASCII_EXTENDED_MIN = 128;\nconst LIMITE_CARACTERES_INCOMUNS_PADRAO = 10;\nconst ESPACAMENTO_CORRECAO_COUNT = 1;\nconst _CONTEXTO_TYPESCRIPT_LOOKBACK = 50;\nconst _CONTEXTO_TYPESCRIPT_LOOKAHEAD = 50;\nconst _MIN_CONFIANCA_ALTA = 80;\nconst CONFIANCA_UNICODE = 90;\nconst CONFIANCA_PONTUACAO = 95;\nconst CONFIANCA_ESPACAMENTO = 85;\nconst CONFIANCA_CARACTERES_INCOMUNS = 70;\n\nconst COMMON_REPLACEMENTS: Record<string, string> = {\n  '\\u201c': '\"',\n  '\\u201d': '\"',\n  '\\u2018': \"'\",\n  '\\u2019': \"'\",\n  '\\u2013': '-',\n  '\\u2014': '-',\n  '\\u00A0': ' ',\n  '\\u00B4': \"'\",\n};\n\nconst REPEATABLE_TO_SINGLE = new Set([\n  ',',\n  '.',\n  '!',\n  '?',\n  ':',\n  ';',\n  '-',\n  '_',\n  '*',\n]);\nconst MULTI_PUNCT_RE = /([,\\.!?:;_\\-\\*]){2,}/g;\nconst SPACE_BEFORE_PUNCT_RE = /\\s+([,.:;!?])/g;\nconst NO_SPACE_AFTER_PUNCT_RE = /([,.:;!?])([^\\s\\)\\]\\}])/g;\n\nconst CONFIGURACAO_PADRAO: ConfiguracaoPontuacaoZelador = {\n  normalizarUnicode: true,\n  colapsarPontuacaoRepetida: true,\n  corrigirEspacamento: true,\n  balancearParenteses: false,\n  detectarCaracteresIncomuns: true,\n  limiteCaracteresIncomuns: LIMITE_CARACTERES_INCOMUNS_PADRAO,\n};\n\nfunction normalizeUnicode(input: string): { text: string; changed: boolean } {\n  let normalized = input.normalize('NFKC');\n  let changed = false;\n  for (const [pattern, replacement] of Object.entries(COMMON_REPLACEMENTS)) {\n    if (normalized.includes(pattern)) {\n      normalized = normalized.split(pattern).join(replacement);\n      changed = true;\n    }\n  }\n  return { text: normalized, changed };\n}\n\nfunction collapseRepeatedPunct(s: string): {\n  text: string;\n  changed: boolean;\n  count: number;\n} {\n  let count = 0;\n  const text = s.replace(MULTI_PUNCT_RE, (m: string) => {\n    count++;\n    const ch = m[0];\n    if (REPEATABLE_TO_SINGLE.has(ch)) return ch;\n    return m;\n  });\n  return { text, changed: count > 0, count };\n}\n\nfunction fixSpacingAroundPunct(s: string): {\n  text: string;\n  changed: boolean;\n  count: number;\n} {\n  const t1 = s.replace(SPACE_BEFORE_PUNCT_RE, '$1');\n  const t2 = t1.replace(NO_SPACE_AFTER_PUNCT_RE, '$1 $2');\n  const changed = s !== t2;\n  const count = changed ? ESPACAMENTO_CORRECAO_COUNT : 0;\n  return { text: t2, changed, count };\n}\n\nfunction detectUncommonChars(\n  text: string,\n  limite?: number,\n): ProblemaPontuacao[] {\n  const issues: ProblemaPontuacao[] = [];\n  for (\n    let i = 0;\n    i < text.length && issues.length < (limite ?? Infinity);\n    i++\n  ) {\n    const ch = text[i];\n    const code = ch.codePointAt(0) ?? 0;\n    if (code >= ASCII_EXTENDED_MIN) {\n      const name = (() => {\n        try {\n          if (typeof Intl !== 'undefined') {\n            const maybe = Intl as IntlComDisplayNames;\n            const DisplayNamesCtor = maybe.DisplayNames;\n            if (DisplayNamesCtor) {\n              const displayNames = new DisplayNamesCtor(['en'], {\n                type: 'language',\n              });\n              return typeof displayNames.of === 'function'\n                ? (displayNames.of(ch) ?? '')\n                : '';\n            }\n          }\n          return '';\n        } catch {\n          return '';\n        }\n      })();\n      issues.push({\n        tipo: 'caracteres-incomuns',\n        posicao: i,\n        comprimento: 1,\n        descricao: `Caractere incomum: ${ch} (${name || ch})`,\n        sugestao: 'Considere substituir por equivalente ASCII',\n        confianca: CONFIANCA_CARACTERES_INCOMUNS,\n      });\n    }\n  }\n  return issues;\n}\n\nfunction analisarTexto(\n  src: string,\n  config: ConfiguracaoPontuacaoZelador = CONFIGURACAO_PADRAO,\n): ProblemaPontuacao[] {\n  const problemas: ProblemaPontuacao[] = [];\n\n  if (config.normalizarUnicode) {\n    const norm = normalizeUnicode(src);\n    if (norm.changed) {\n      problemas.push({\n        tipo: 'unicode-invalido',\n        posicao: 0,\n        comprimento: src.length,\n        descricao: 'Texto cont√©m caracteres Unicode que podem ser normalizados',\n        sugestao: 'Aplicar normaliza√ß√£o Unicode NFKC',\n        confianca: CONFIANCA_UNICODE,\n      });\n    }\n  }\n\n  if (config.colapsarPontuacaoRepetida) {\n    const collapsed = collapseRepeatedPunct(src);\n    if (collapsed.changed) {\n      problemas.push({\n        tipo: 'pontuacao-repetida',\n        posicao: 0,\n        comprimento: src.length,\n        descricao: `Encontrados ${collapsed.count} casos de pontua√ß√£o repetida`,\n        sugestao: 'Colapsar pontua√ß√£o repetida para caracteres √∫nicos',\n        confianca: CONFIANCA_PONTUACAO,\n      });\n    }\n  }\n\n  if (config.corrigirEspacamento) {\n    const spacing = fixSpacingAroundPunct(src);\n    if (spacing.changed) {\n      problemas.push({\n        tipo: 'espacamento-incorreto',\n        posicao: 0,\n        comprimento: src.length,\n        descricao: `Encontrados ${spacing.count} problemas de espa√ßamento em pontua√ß√£o`,\n        sugestao: 'Corrigir espa√ßamento antes/depois de pontua√ß√£o',\n        confianca: CONFIANCA_ESPACAMENTO,\n      });\n    }\n  }\n\n  if (config.detectarCaracteresIncomuns) {\n    const uncommon = detectUncommonChars(\n      src,\n      config.limiteCaracteresIncomuns ?? undefined,\n    );\n    problemas.push(...uncommon);\n  }\n\n  return problemas;\n}\n\nfunction mapearCategoriaNivel(\n  category: PatternBasedQuickFix['category'],\n): 'info' | 'aviso' | 'erro' {\n  switch (category) {\n    case 'security':\n      return 'erro';\n    case 'performance':\n      return 'aviso';\n    case 'style':\n    case 'documentation':\n      return 'info';\n    default:\n      return 'info';\n  }\n}\n\nfunction calcularLinha(\n  src: string,\n  posOrIndex: number | undefined,\n  match?: RegExpMatchArray,\n): number {\n  if (typeof posOrIndex === 'number') {\n    const before = src.substring(0, posOrIndex);\n    return before.split('\\n').length;\n  }\n  // fallback: try to compute from match.index\n  if (match) {\n    const idx = (match as RegExpMatchArray & { index?: number }).index;\n    if (typeof idx === 'number') {\n      const before = src.substring(0, idx);\n      return before.split('\\n').length;\n    }\n  }\n  return 1;\n}\n\n  /* -------------------------- analistaQuickFixes -------------------------- */\n\nexport const analistaQuickFixes: Analista = {\n  nome: 'quick-fixes',\n  categoria: 'melhorias',\n  descricao: 'Detecta problemas comuns e oferece corre√ß√µes autom√°ticas',\n\n  test: (relPath: string): boolean => {\n    // Inclui SVGs para permitir quick-fixes seguros (otimiza√ß√£o e viewBox)\n    return /\\.(js|jsx|ts|tsx|mjs|cjs|svg)$/.test(relPath);\n  },\n\n  aplicar: (\n    src: string,\n    relPath: string,\n    _ast: NodePath<Node> | null,\n  ): Ocorrencia[] => {\n    if (!src) return [];\n\n    const ocorrencias: Ocorrencia[] = [];\n\n    // Quick fixes gerais\n    const quickFixes = findQuickFixes(src, undefined, undefined, relPath);\n\n    // Quick fixes espec√≠ficos por tipo de problema detectado\n    const problemaTypes = [\n      'unhandled-async',\n      'console-log',\n      'memory-leak',\n      'dangerous-html',\n      'eval-usage',\n      'complex-regex',\n    ];\n\n    for (const problemType of problemaTypes) {\n      const specificFixes = findQuickFixes(\n        src,\n        problemType,\n        undefined,\n        relPath,\n      );\n      quickFixes.push(...specificFixes);\n    }\n\n    // Remover duplicatas por ID\n    const uniqueFixes = quickFixes.filter(\n      (fix, index, arr) => arr.findIndex((f) => f.id === fix.id) === index,\n    );\n\n    for (const fixResult of uniqueFixes) {\n      for (const match of fixResult.matches) {\n        const linha = calcularLinha(src, match.index, match);\n\n        const previewFix = fixResult.fix(match, src);\n        const originalLine = src.split('\\n')[linha - 1] || '';\n        const fixedLine = previewFix.split('\\n')[linha - 1] || '';\n\n        const sugestao = [\n          fixResult.description,\n          '',\n          `üîß Corre√ß√£o sugerida:`,\n          `‚ùå Antes: ${originalLine.trim()}`,\n          `‚úÖ Depois: ${fixedLine.trim()}`,\n          '',\n          `Confian√ßa: ${fixResult.confidence}%`,\n          `Categoria: ${fixResult.category}`,\n          `ID do Fix: ${fixResult.id}`,\n        ].join('\\n');\n\n        const nivel = mapearCategoriaNivel(fixResult.category);\n\n        const ocorrencia = criarOcorrencia({\n          tipo: 'auto-fix-disponivel',\n          nivel,\n          mensagem: `${fixResult.title}`,\n          relPath,\n          linha,\n        });\n\n        const ocorrenciaGenerica = ocorrencia as Ocorrencia & {\n          sugestao?: string;\n          quickFixId?: string;\n          confidence?: number;\n          category?: string;\n          matchIndex?: number;\n          matchLength?: number;\n        };\n        ocorrenciaGenerica.sugestao = sugestao;\n        ocorrenciaGenerica.quickFixId = fixResult.id;\n        ocorrenciaGenerica.confidence = fixResult.confidence;\n        ocorrenciaGenerica.category = fixResult.category;\n        ocorrenciaGenerica.matchIndex = match.index;\n        ocorrenciaGenerica.matchLength = match[0].length;\n\n        ocorrencias.push(ocorrencia);\n      }\n    }\n\n    return ocorrencias;\n  },\n};\n\n  /* -------------------------- analistaPontuacao -------------------------- */\n\nexport const analistaPontuacao: Analista = {\n  nome: 'pontuacao-fix',\n  categoria: 'formatacao',\n  descricao:\n    'Detecta problemas de pontua√ß√£o, caracteres estranhos e formata√ß√£o de texto',\n\n  test: (relPath: string): boolean => {\n    return /\\.(ts|js|tsx|jsx|mjs|cjs|md|txt|json)$/.test(relPath);\n  },\n\n  aplicar: (src: string, relPath: string): Ocorrencia[] => {\n    if (!src) return [];\n\n    const problemas = analisarTexto(src);\n    const ocorrencias: Ocorrencia[] = [];\n\n    for (const problema of problemas) {\n      const linha = calcularLinha(src, problema.posicao);\n\n      const linhas = src.split('\\n');\n      const contexto = linhas[linha - 1] || '';\n\n      const ocorrencia = criarOcorrencia({\n        tipo: problema.tipo,\n        nivel: (problema.confianca ?? 0) > 80 ? 'aviso' : 'info',\n        mensagem: problema.descricao,\n        relPath,\n        linha,\n      });\n\n      const ocorrenciaExtendida = ocorrencia as Ocorrencia & {\n        sugestao?: string;\n        confianca?: number;\n        contexto?: string;\n      };\n      ocorrenciaExtendida.sugestao = problema.sugestao;\n      ocorrenciaExtendida.confianca = problema.confianca;\n      ocorrenciaExtendida.contexto = contexto;\n\n      ocorrencias.push(ocorrencia);\n    }\n\n    return ocorrencias;\n  },\n};\n\n  /* -------------------------- Exports adicionais -------------------------- */\n\nexport const analistas: Analista[] = [analistaQuickFixes, analistaPontuacao];\n"]}