{"version":3,"file":"detector-codigo-fragil.js","sourceRoot":"","sources":["../../../src/analistas/detectores/detector-codigo-fragil.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\nimport type { NodePath } from '/traverse';\nimport type {\n  ArrowFunctionExpression,\n  CallExpression,\n  CatchClause,\n  ClassMethod,\n  FunctionDeclaration,\n  FunctionExpression,\n  Node,\n  NumericLiteral,\n  TSAnyKeyword,\n} from '/types';\nimport { config } from '/config/config.js';\nimport { traverse } from '/config/traverse.js';\nimport { DetectorCodigoFragilMessages } from '/messages/analistas/detector-codigo-fragil-messages.js';\nimport { detectarFrameworks } from '/helpers/framework-detector.js';\nimport { isWhitelistedConstant } from '/helpers/magic-constants-whitelist.js';\nimport { filtrarOcorrenciasSuprimidas } from '/helpers/suppressao.js';\n\nimport type { Analista, Fragilidade, Ocorrencia } from '@';\nimport { criarOcorrencia } from '@';\n\n// Cache de frameworks detectados (evita múltiplas leituras do package.json)\nlet frameworksDetectados: string[] | null = null;\n\nexport const analistaCodigoFragil: Analista = {\n  nome: 'codigo-fragil',\n  categoria: 'qualidade',\n  descricao: 'Detecta padrões de código que podem levar a problemas futuros',\n  limites: {\n    maxLinhasFuncao:\n      config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_LINHAS_FUNCAO ?? 30,\n    maxParametros: config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_PARAMETROS ?? 4,\n    maxNestedCallbacks:\n      config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_NESTED_CALLBACKS ?? 2,\n  },\n\n  test: (relPath: string): boolean => {\n    // Ignorar arquivos deprecados e abandonados\n    if (\n      /\\.(deprecados?|abandonados?)\\//i.test(relPath) ||\n      relPath.includes('.deprecados/') ||\n      relPath.includes('abandonados/')\n    ) {\n      return false;\n    }\n    return /\\.(js|jsx|ts|tsx|mjs|cjs)$/.test(relPath);\n  },\n\n  aplicar: (\n    src: string,\n    relPath: string,\n    ast: NodePath<Node> | null,\n  ): Ocorrencia[] => {\n    if (!ast || !src) {\n      return [];\n    }\n\n    // Limites efetivos (lidos dinamicamente para respeitar overrides por env/config)\n    const maxLinhasFuncao =\n      config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_LINHAS_FUNCAO ?? 30;\n    const maxParametros =\n      config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_PARAMETROS ?? 4;\n    const maxNestedCallbacks =\n      config.ANALISE_LIMITES?.CODIGO_FRAGIL?.MAX_NESTED_CALLBACKS ?? 2;\n\n    const fragilidades: Fragilidade[] = [];\n\n    try {\n      // Detectar problemas baseados em texto\n      detectarConsoleLog(src, fragilidades);\n      detectarTodoComments(src, fragilidades);\n\n      // Detecções avançadas baseadas em texto\n      detectarProblemasAvancados(src, fragilidades);\n\n      // Detectar problemas via AST\n      traverse(ast.node, {\n        // Blocos catch vazios\n        CatchClause(path: NodePath<CatchClause>) {\n          const body = path.node.body.body;\n          const linha = path.node.loc?.start.line || 0;\n\n          if (body.length === 0) {\n            fragilidades.push({\n              tipo: 'catch-vazio',\n              linha,\n              coluna: path.node.loc?.start.column || 0,\n              severidade: 'media',\n              contexto: 'Bloco catch vazio',\n            });\n          } else if (body.length === 1 && isSingleConsoleLog(body[0])) {\n            fragilidades.push({\n              tipo: 'catch-apenas-log',\n              linha,\n              coluna: path.node.loc?.start.column || 0,\n              severidade: 'baixa',\n              contexto: 'Catch apenas com console.log',\n            });\n          }\n        },\n\n        // Uso explícito de 'any'\n        TSAnyKeyword(path: NodePath<TSAnyKeyword>) {\n          fragilidades.push({\n            tipo: 'any-explicito',\n            linha: path.node.loc?.start.line || 0,\n            coluna: path.node.loc?.start.column || 0,\n            severidade: 'media',\n            contexto: 'Tipo any explícito',\n          });\n        },\n\n        // Funções muito longas + muitos parâmetros\n        FunctionDeclaration(path: NodePath<FunctionDeclaration>) {\n          const node = path.node;\n\n          // Verificar tamanho da função\n          if (node.body?.type === 'BlockStatement') {\n            const inicio = node.loc?.start.line || 0;\n            const fim = node.loc?.end.line || 0;\n            const numLinhas = fim - inicio;\n\n            if (numLinhas > maxLinhasFuncao) {\n              fragilidades.push({\n                tipo: 'funcao-longa',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade:\n                  numLinhas >\n                  Math.max(\n                    maxLinhasFuncao + 20,\n                    Math.floor(maxLinhasFuncao * 1.7),\n                  )\n                    ? 'alta'\n                    : 'media',\n                contexto: `Função com ${numLinhas} linhas (máx: ${maxLinhasFuncao})`,\n              });\n            }\n          }\n\n          // Verificar número de parâmetros\n          const numParams = node.params.length;\n          if (numParams > maxParametros) {\n            fragilidades.push({\n              tipo: 'muitos-parametros',\n              linha: node.loc?.start.line || 0,\n              coluna: node.loc?.start.column || 0,\n              severidade:\n                numParams >\n                Math.max(maxParametros + 2, Math.floor(maxParametros * 1.5))\n                  ? 'alta'\n                  : 'media',\n              contexto: `Função com ${numParams} parâmetros (máx: ${maxParametros})`,\n            });\n          }\n        },\n\n        ArrowFunctionExpression(path: NodePath<ArrowFunctionExpression>) {\n          const node = path.node;\n          if (node.body?.type === 'BlockStatement') {\n            const inicio = node.loc?.start.line || 0;\n            const fim = node.loc?.end.line || 0;\n            const numLinhas = fim - inicio;\n\n            if (numLinhas > maxLinhasFuncao) {\n              fragilidades.push({\n                tipo: 'funcao-longa',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade:\n                  numLinhas >\n                  Math.max(\n                    maxLinhasFuncao + 20,\n                    Math.floor(maxLinhasFuncao * 1.7),\n                  )\n                    ? 'alta'\n                    : 'media',\n                contexto: `Arrow function com ${numLinhas} linhas (máx: ${maxLinhasFuncao})`,\n              });\n            }\n          }\n        },\n\n        FunctionExpression(path: NodePath<FunctionExpression>) {\n          const node = path.node;\n          if (node.body?.type === 'BlockStatement') {\n            const inicio = node.loc?.start.line || 0;\n            const fim = node.loc?.end.line || 0;\n            const numLinhas = fim - inicio;\n\n            if (numLinhas > maxLinhasFuncao) {\n              fragilidades.push({\n                tipo: 'funcao-longa',\n                linha: inicio,\n                coluna: node.loc?.start.column || 0,\n                severidade:\n                  numLinhas >\n                  Math.max(\n                    maxLinhasFuncao + 20,\n                    Math.floor(maxLinhasFuncao * 1.7),\n                  )\n                    ? 'alta'\n                    : 'media',\n                contexto: `Function expression com ${numLinhas} linhas (máx: ${maxLinhasFuncao})`,\n              });\n            }\n          }\n        },\n\n        // Números mágicos\n        NumericLiteral(path: NodePath<NumericLiteral>) {\n          const value = path.node.value;\n\n          // Ignorar se está em declaração de variável ou índice de array\n          if (isInVariableDeclarator(path) || isInArrayIndex(path)) {\n            return;\n          }\n\n          // Detectar frameworks do projeto (cache básico via closure)\n          if (!frameworksDetectados) {\n            const rootDir = process.cwd();\n            const frameworks = detectarFrameworks(rootDir);\n            frameworksDetectados = frameworks.map((f) => f.name);\n          }\n\n          // Verificar se está na whitelist (valores comuns + limites de frameworks)\n          if (isWhitelistedConstant(value, frameworksDetectados)) {\n            return;\n          }\n\n          fragilidades.push({\n            tipo: 'magic-number',\n            linha: path.node.loc?.start.line || 0,\n            coluna: path.node.loc?.start.column || 0,\n            severidade: 'baixa',\n            contexto: `Número mágico: ${value}`,\n          });\n        },\n\n        // Muitos parâmetros - ClassMethod\n        ClassMethod(path: NodePath<ClassMethod>) {\n          const node = path.node;\n          const numParams =\n            node.params && Array.isArray(node.params) ? node.params.length : 0;\n\n          if (numParams > 4) {\n            fragilidades.push({\n              tipo: 'muitos-parametros',\n              linha: node.loc?.start.line || 0,\n              coluna: node.loc?.start.column || 0,\n              severidade: numParams > 6 ? 'alta' : 'media',\n              contexto: `Método com ${numParams} parâmetros`,\n            });\n          }\n        },\n      });\n\n      // Detectar callbacks aninhados (requer análise específica)\n      detectarNestedCallbacks(ast, fragilidades, maxNestedCallbacks);\n\n      // Gerar ocorrências por severidade\n      const ocorrencias: Ocorrencia[] = [];\n\n      // Agrupar por severidade\n      const porSeveridade = agruparPorSeveridade(fragilidades);\n\n      for (const [severidade, items] of Object.entries(porSeveridade)) {\n        if (items.length > 0) {\n          const nivel =\n            severidade === 'alta'\n              ? 'erro'\n              : severidade === 'media'\n                ? 'aviso'\n                : 'info';\n\n          // Criar resumo por tipo\n          const resumoPorTipo = items.reduce(\n            (acc, item) => {\n              acc[item.tipo] = (acc[item.tipo] || 0) + 1;\n              return acc;\n            },\n            {} as Record<string, number>,\n          );\n\n          const resumo = Object.entries(resumoPorTipo)\n            .map(([tipo, count]) => `${tipo}: ${count}`)\n            .join(', ');\n\n          ocorrencias.push(\n            criarOcorrencia({\n              tipo: 'codigo-fragil',\n              nivel,\n              mensagem: DetectorCodigoFragilMessages.fragilidadesResumo(\n                severidade,\n                resumo,\n                {\n                  severidade,\n                  total: items.length,\n                  tipos: resumoPorTipo,\n                  amostra: items\n                    .slice(0, 3)\n                    .map((f) => `${f.tipo}:L${f.linha}`),\n                },\n              ),\n              relPath,\n              linha: items[0].linha,\n            }),\n          );\n        }\n      }\n\n      // Aplicar supressões inline antes de retornar\n      return filtrarOcorrenciasSuprimidas(ocorrencias, 'codigo-fragil', src);\n    } catch (erro) {\n      return [\n        criarOcorrencia({\n          tipo: 'ERRO_ANALISE',\n          nivel: 'aviso',\n          mensagem: DetectorCodigoFragilMessages.erroAnalisarCodigoFragil(erro),\n          relPath,\n          linha: 1,\n        }),\n      ];\n    }\n  },\n};\n\nfunction detectarConsoleLog(src: string, fragilidades: Fragilidade[]): void {\n  const lines = src.split('\\n');\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const trimmedLine = line.trim();\n\n    // Ignorar linhas comentadas (// ou /* ... */)\n    if (\n      trimmedLine.startsWith('//') ||\n      (trimmedLine.startsWith('/*') && trimmedLine.endsWith('*/'))\n    ) {\n      continue;\n    }\n\n    // Detectar console.log não comentado\n    const consoleMatch = line.match(/console\\.log\\s*\\(/);\n    if (consoleMatch) {\n      // Verificar se não está dentro de comentário de bloco\n      const beforeMatch = line.substring(0, consoleMatch.index);\n      if (beforeMatch.includes('/*') && !beforeMatch.includes('*/')) {\n        continue; // Está dentro de comentário de bloco\n      }\n\n      fragilidades.push({\n        tipo: 'console-log',\n        linha: i + 1,\n        coluna: consoleMatch.index || 0,\n        severidade: 'baixa',\n        contexto: 'console.log encontrado',\n      });\n    }\n  }\n}\n\nfunction detectarTodoComments(src: string, fragilidades: Fragilidade[]): void {\n  const regex = /\\/\\/\\s*TODO|\\/\\*\\s*TODO/gi;\n  let match;\n\n  while ((match = regex.exec(src)) !== null) {\n    const linha = src.substring(0, match.index).split('\\n').length;\n\n    fragilidades.push({\n      tipo: 'todo-comment',\n      linha,\n      coluna: 0,\n      severidade: 'baixa',\n      contexto: 'Comentário TODO encontrado',\n    });\n  }\n}\n\n/**\n * Detecta problemas avançados de código que indicam fragilidade (não duplicados com outros analistas)\n */\nfunction detectarProblemasAvancados(\n  src: string,\n  fragilidades: Fragilidade[],\n): void {\n  const lines = src.split('\\n');\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const trimmedLine = line.trim();\n\n    // Ignorar linhas comentadas\n    if (\n      trimmedLine.startsWith('//') ||\n      (trimmedLine.startsWith('/*') && trimmedLine.endsWith('*/'))\n    ) {\n      continue;\n    }\n\n    // Promise sem catch (exclusivo - não coberto por outros analistas)\n    if (/\\.then\\s*\\(/.test(line) && !line.includes('.catch')) {\n      const nextLines = lines.slice(i, Math.min(i + 3, lines.length)).join(' ');\n      if (!nextLines.includes('.catch')) {\n        fragilidades.push({\n          tipo: 'promise-sem-catch',\n          linha: i + 1,\n          coluna: line.indexOf('.then'),\n          severidade: 'media',\n          contexto: 'Promise sem tratamento de erro (.catch)',\n        });\n      }\n    }\n\n    // addEventListener sem removeEventListener (detecção aprimorada)\n    if (/addEventListener\\s*\\(/.test(line)) {\n      const eventName = line.match(\n        /addEventListener\\s*\\(\\s*['\"`]([^'\"`]+)['\"`]/,\n      );\n      if (\n        eventName &&\n        !src.includes(`removeEventListener`) &&\n        !src.includes(`{ once: true }`) &&\n        !src.includes('AbortController')\n      ) {\n        fragilidades.push({\n          tipo: 'event-listener-sem-cleanup',\n          linha: i + 1,\n          coluna: line.indexOf('addEventListener'),\n          severidade: 'media',\n          contexto: `Event listener '${eventName[1]}' sem cleanup`,\n        });\n      }\n    }\n\n    // Regex complexa (mais de 50 caracteres com múltiplos grupos)\n    const regexMatch = line.match(/\\/([^\\/\\\\]|\\\\.)+\\/[gimuy]*/);\n    if (\n      regexMatch &&\n      regexMatch[0].length > 50 &&\n      (regexMatch[0].match(/\\(/g) || []).length > 3\n    ) {\n      fragilidades.push({\n        tipo: 'regex-complexa',\n        linha: i + 1,\n        coluna: line.indexOf(regexMatch[0]),\n        severidade: 'media',\n        contexto: 'Regex complexa - considere quebrar em partes menores',\n      });\n    }\n\n    // Potencial vazamento de memória - setInterval/setTimeout sem clear + addEventListener sem remove\n    if (\n      (/setInterval\\s*\\(/.test(line) || /setTimeout\\s*\\(/.test(line)) &&\n      !src.includes('clear') &&\n      !line.includes('once')\n    ) {\n      fragilidades.push({\n        tipo: 'memory-leak-potential',\n        linha: i + 1,\n        coluna: line.search(/setInterval|setTimeout/),\n        severidade: 'media',\n        contexto: 'Potencial vazamento: timer sem cleanup',\n      });\n    }\n  }\n\n  // Detectar complexidade cognitiva (mais avançado que funções longas)\n  detectarComplexidadeCognitiva(src, fragilidades);\n}\n\n/**\n * Detecta complexidade cognitiva alta baseada em estruturas de controle (mais avançado que analista de funções longas)\n */\nfunction detectarComplexidadeCognitiva(\n  src: string,\n  fragilidades: Fragilidade[],\n): void {\n  const lines = src.split('\\n');\n  let complexityScore = 0;\n  let currentFunction = '';\n  let functionStartLine = 0;\n  let nestingLevel = 0;\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n    const trimmedLine = line.trim();\n\n    // Início de função\n    if (\n      /^(function|const\\s+\\w+\\s*=|let\\s+\\w+\\s*=|var\\s+\\w+\\s*=).*=>|^function\\s+\\w+|^async\\s+function/.test(\n        trimmedLine,\n      )\n    ) {\n      if (complexityScore > 15) {\n        // Threshold mais alto que funções longas\n        fragilidades.push({\n          tipo: 'cognitive-complexity',\n          linha: functionStartLine,\n          coluna: 0,\n          severidade: 'alta',\n          contexto: `Função '${currentFunction}' com complexidade cognitiva crítica (${complexityScore})`,\n        });\n      }\n\n      complexityScore = 1;\n      currentFunction = `${trimmedLine.substring(0, 30)}...`;\n      functionStartLine = i + 1;\n      nestingLevel = 0;\n    }\n\n    // Detectar nível de aninhamento\n    const openBraces = (line.match(/\\{/g) || []).length;\n    const closeBraces = (line.match(/\\}/g) || []).length;\n    nestingLevel += openBraces - closeBraces;\n\n    // Incrementar complexidade para estruturas de controle com peso por aninhamento\n    const controlStructures =\n      /(if|else if|while|for|switch|case|catch|&&|\\|\\||\\?|:)/.test(trimmedLine);\n    if (controlStructures) {\n      complexityScore += Math.max(1, nestingLevel); // Peso maior para aninhamento profundo\n    }\n\n    // Callbacks e async aumentam complexidade\n    if (\n      /\\.then|\\.catch|callback|setTimeout|setInterval|async\\s*\\(/.test(\n        trimmedLine,\n      )\n    ) {\n      complexityScore += 2;\n    }\n\n    // Regex complexa e condições ternárias aninhadas\n    if (/\\?\\s*.*\\?\\s*.*:/.test(trimmedLine)) {\n      // Ternário aninhado\n      complexityScore += 3;\n    }\n\n    // Try-catch aumenta complexidade\n    if (/try\\s*\\{|catch\\s*\\(/.test(trimmedLine)) {\n      complexityScore += 2;\n    }\n  }\n\n  // Verificar última função\n  if (complexityScore > 15) {\n    fragilidades.push({\n      tipo: 'cognitive-complexity',\n      linha: functionStartLine,\n      coluna: 0,\n      severidade: 'alta',\n      contexto: `Função '${currentFunction}' com complexidade cognitiva crítica (${complexityScore})`,\n    });\n  }\n}\n\nfunction detectarNestedCallbacks(\n  ast: NodePath<Node>,\n  fragilidades: Fragilidade[],\n  limite: number,\n): void {\n  const lim = Number.isFinite(limite) && limite >= 0 ? limite : 2;\n\n  traverse(ast.node, {\n    CallExpression(path: NodePath<CallExpression>) {\n      const profundidade = calcularProfundidadeCallback(path);\n      if (profundidade > lim) {\n        fragilidades.push({\n          tipo: 'nested-callbacks',\n          linha: path.node.loc?.start.line || 0,\n          coluna: path.node.loc?.start.column || 0,\n          severidade: profundidade > lim + 1 ? 'alta' : 'media',\n          contexto: `Callbacks aninhados (nível ${profundidade}, máx: ${lim})`,\n        });\n      }\n    },\n  });\n}\n\nfunction calcularProfundidadeCallback(path: NodePath): number {\n  let profundidade = 0;\n  let current: NodePath | null = path;\n\n  while (current) {\n    if (current.isCallExpression() && hasCallbackArgument(current)) {\n      profundidade++;\n    }\n    current = current.parentPath;\n  }\n\n  return profundidade;\n}\n\nfunction hasCallbackArgument(path: NodePath): boolean {\n  if (!path.isCallExpression()) return false;\n\n  return path.node.arguments.some(\n    (arg) =>\n      arg.type === 'ArrowFunctionExpression' ||\n      arg.type === 'FunctionExpression',\n  );\n}\n\nfunction isSingleConsoleLog(stmt: Node): boolean {\n  // Statement node\n  return (\n    stmt.type === 'ExpressionStatement' &&\n    stmt.expression?.type === 'CallExpression' &&\n    stmt.expression.callee?.type === 'MemberExpression' &&\n    stmt.expression.callee.object?.type === 'Identifier' &&\n    stmt.expression.callee.object.name === 'console'\n  );\n}\n\nfunction isInVariableDeclarator(path: NodePath): boolean {\n  return path.findParent((p) => p.isVariableDeclarator()) !== null;\n}\n\nfunction isInArrayIndex(path: NodePath): boolean {\n  return (\n    path.findParent((p) => p.isMemberExpression() && p.node.computed) !== null\n  );\n}\n\nfunction agruparPorSeveridade(\n  fragilidades: Fragilidade[],\n): Record<string, Fragilidade[]> {\n  return fragilidades.reduce(\n    (acc, frag) => {\n      const sev = (frag.severidade as string) || 'media';\n      if (!acc[sev]) {\n        acc[sev] = [];\n      }\n      acc[sev].push(frag);\n      return acc;\n    },\n    {} as Record<string, Fragilidade[]>,\n  );\n}\n"]}