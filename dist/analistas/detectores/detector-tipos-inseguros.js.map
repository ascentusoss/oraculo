{"version":3,"file":"detector-tipos-inseguros.js","sourceRoot":"","sources":["../../../src/analistas/detectores/detector-tipos-inseguros.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n/**\n * Detector de tipos inseguros (any e unknown) - Vers√£o Inteligente\n * Identifica uso de any e unknown com an√°lise contextual avan√ßada\n *\n * Estrat√©gia:\n * - Analisa contexto para determinar legitimidade do uso\n * - Sugere alternativas espec√≠ficas quando poss√≠vel\n * - Explica variantes e possibilidades quando an√°lise √© incerta\n * - Sempre recomenda revis√£o manual para casos complexos\n */\n\nimport {\n  categorizarUnknown,\n  extractVariableName,\n  isAnyInGenericFunction,\n  isInStringOrComment,\n  isLegacyOrVendorFile,\n  isTypeScriptContext,\n  isUnknownInGenericContext,\n} from '@analistas/corrections/type-safety/context-analyzer.js';\nimport type { NodePath } from '@babel/traverse';\nimport type { Node } from '@babel/types';\nimport { config } from '@core/config/config.js';\nimport { shouldSuppressOccurrence } from '@shared/helpers/rule-config.js';\n\nimport type { Analista, Ocorrencia } from '@';\n\nconst ANALISTA: Analista = {\n  nome: 'detector-tipos-inseguros',\n  categoria: 'code-quality',\n  descricao:\n    'Detecta uso de any e unknown que podem ser substitu√≠dos por tipos espec√≠ficos',\n\n  test: (relPath: string) => {\n    return relPath.endsWith('.ts') || relPath.endsWith('.tsx');\n  },\n\n  aplicar: async (\n    srcParam: string,\n    relPath: string,\n    _ast: NodePath<Node> | null,\n    fullPath?: string,\n  ): Promise<Ocorrencia[]> => {\n    const ocorrencias: Ocorrencia[] = [];\n\n    // IMPORTANTE: Normaliza√ß√£o de line endings para compatibilidade Windows/Linux\n    // Sem isso, arquivos com \\r\\n causam split('\\n') incorreto (retorna 1 linha)\n    // Ver: docs/reports/DEBUG-TYPE-SAFETY-DETECTOR-2025-11-03.md\n    const src = srcParam.replace(/\\r\\n/g, '\\n');\n\n    // Ignorar arquivos de teste quando permitido na configura√ß√£o\n    const isTestFile = (p: string) => {\n      const rel = p.replace(/\\\\/g, '/').toLowerCase();\n      return (\n        /(^|\\/)tests?(\\/|\\.)/.test(rel) ||\n        /__tests__/.test(rel) ||\n        /\\.(test|spec)\\.(ts|tsx|js|jsx)$/.test(rel)\n      );\n    };\n    const allowAnyInTests = Boolean(\n      (config as unknown as { testPatterns?: { allowAnyType?: boolean } })\n        .testPatterns?.allowAnyType,\n    );\n    if (allowAnyInTests && isTestFile(fullPath || relPath)) {\n      return ocorrencias;\n    }\n\n    // Verificar se √© arquivo que deve ser ignorado\n    if (isLegacyOrVendorFile(fullPath || relPath)) {\n      return ocorrencias;\n    }\n\n    // Detectar uso de any\n    const anyPattern = /:\\s*any\\b/g;\n    let anyMatch: RegExpMatchArray | null;\n\n    while ((anyMatch = anyPattern.exec(src)) !== null) {\n      const position = anyMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n\n      // Pular se estiver em contexto TypeScript espec√≠fico (type assertions)\n      if (isTypeScriptContext(src, position)) {\n        continue;\n      }\n\n      // Pular se any est√° em fun√ß√£o gen√©rica apropriada\n      if (isAnyInGenericFunction(src, position)) {\n        continue;\n      }\n\n      // Extrair nome da vari√°vel e contexto\n      const varName = extractVariableName(anyMatch, src);\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n\n      // An√°lise contextual para any\n      let mensagem = '';\n      let sugestao = '';\n\n      // Detectar padr√µes espec√≠ficos\n      if (/catch\\s*\\(\\s*\\w+\\s*:\\s*any\\s*\\)/.test(lineContext)) {\n        mensagem = varName\n          ? `'any' em catch block '${varName}' - TypeScript recomenda 'unknown'`\n          : \"'any' em catch block - TypeScript recomenda 'unknown'\";\n        sugestao = 'Substitua por: catch (error: unknown) { ... }';\n      } else if (/callback\\s*:\\s*\\([^)]*:\\s*any/.test(lineContext)) {\n        mensagem = varName\n          ? `Callback '${varName}' com par√¢metro 'any' - tipagem fraca`\n          : \"Callback com par√¢metro 'any' - tipagem fraca\";\n        sugestao =\n          'Defina interface do callback: (param: TipoEspecifico) => void';\n      } else if (/event\\s*:\\s*any|e\\s*:\\s*any/.test(lineContext)) {\n        mensagem = varName\n          ? `Event handler '${varName}' com 'any' - pode usar Event types`\n          : \"Event handler com 'any' - pode usar Event types\";\n        sugestao =\n          'Use tipos do DOM: MouseEvent, KeyboardEvent, etc ou React.SyntheticEvent<T>';\n      } else if (/\\[\\s*key\\s*:\\s*string\\s*\\]\\s*:\\s*any/.test(lineContext)) {\n        mensagem = '√çndice extens√≠vel com any - muito permissivo';\n        sugestao =\n          'Use: [key: string]: unknown (mais seguro) ou defina union type';\n      } else if (/Record<[^,]+,\\s*any>/.test(lineContext)) {\n        mensagem = varName\n          ? `Record com 'any' em '${varName}' - sem type safety`\n          : \"Record com 'any' - sem type safety\";\n        sugestao = 'Use Record<string, unknown> ou interface espec√≠fica';\n      } else if (\n        /Array<any>/.test(lineContext) ||\n        /any\\[\\]/.test(lineContext)\n      ) {\n        mensagem = varName\n          ? `Array de 'any' em '${varName}' - perde tipagem`\n          : \"Array de 'any' - perde tipagem\";\n        sugestao =\n          'Especifique tipo do array: string[], number[], CustomType[], etc';\n      } else {\n        // Caso gen√©rico\n        mensagem = varName\n          ? `Tipo 'any' em '${varName}' desabilita verifica√ß√£o de tipos`\n          : \"Tipo 'any' desabilita verifica√ß√£o de tipos\";\n        sugestao =\n          'Analise uso da vari√°vel e defina tipo espec√≠fico ou use unknown com type guards';\n      }\n\n      // Adicionar contexto adicional baseado no arquivo\n      let contextoAdicional = '';\n      if (fullPath?.includes('tipos/')) {\n        contextoAdicional =\n          ' | ‚ö†Ô∏è  Arquivo de tipos - impacta toda base de c√≥digo';\n      } else if (fullPath?.includes('core/') || fullPath?.includes('shared/')) {\n        contextoAdicional =\n          ' | ‚ö†Ô∏è  M√≥dulo core/shared - usado por muitos componentes';\n      }\n\n      const mensagemCompleta = `${mensagem} | üí° ${sugestao}${contextoAdicional} | üîç Revis√£o manual obrigat√≥ria`;\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-any', relPath)) {\n        continue;\n      }\n\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-any',\n        nivel: 'aviso',\n        mensagem: mensagemCompleta,\n        relPath,\n        linha,\n        contexto: lineContext,\n      });\n    }\n\n    /* -------------------------- DETECTAR TYPE ASSERTIONS (as any) -------------------------- */\n    const asAnyPattern = /\\b(as\\s+any)\\b/g;\n    let asAnyMatch: RegExpMatchArray | null;\n\n    while ((asAnyMatch = asAnyPattern.exec(src)) !== null) {\n      const position = asAnyMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n\n      // Extrair contexto da express√£o\n      const after = src.substring(\n        position,\n        Math.min(src.length, position + 50),\n      );\n\n      const mensagem =\n        \"Type assertion 'as any' desabilita verifica√ß√£o de tipos completamente\";\n      let sugestao = '';\n\n      // Detectar padr√µes comuns de type assertion\n      if (/\\)\\s*as\\s+any/.test(lineContext)) {\n        sugestao =\n          'Evite cast de retorno de fun√ß√£o - tipar fun√ß√£o corretamente ou usar unknown com type guard';\n      } else if (/\\.\\w+\\s+as\\s+any/.test(lineContext)) {\n        sugestao =\n          'Evite cast de propriedade - definir tipo correto no objeto pai';\n      } else if (/\\bas\\s+any\\s*\\)/.test(after)) {\n        sugestao =\n          'Type assertion em par√¢metro - definir tipo correto na assinatura da fun√ß√£o chamada';\n      } else {\n        sugestao =\n          'Substitua por tipo espec√≠fico ou use unknown com valida√ß√£o runtime';\n      }\n\n      const mensagemCompleta = `${mensagem} | üí° ${sugestao} | üö® CR√çTICO: Type safety completamente desabilitado | üîç Revis√£o manual obrigat√≥ria`;\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-any-assertion', relPath)) {\n        continue;\n      }\n\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-any-assertion',\n        nivel: 'erro', // Mais severo que declara√ß√£o de tipo\n        mensagem: mensagemCompleta,\n        relPath,\n        linha,\n        contexto: lineContext,\n      });\n    }\n\n    /* -------------------------- DETECTAR ANGLE BRACKET CASTING (<any>) -------------------------- */\n    const angleBracketPattern = /<any>/g;\n    let angleBracketMatch: RegExpMatchArray | null;\n\n    while ((angleBracketMatch = angleBracketPattern.exec(src)) !== null) {\n      const position = angleBracketMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n\n      const mensagemCompleta =\n        \"Type casting '<any>' (sintaxe legada) desabilita type safety | üí° Use sintaxe 'as' moderna e tipo espec√≠fico | üö® CR√çTICO: Migrar para sintaxe moderna e tipo correto | üîç Revis√£o manual obrigat√≥ria\";\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-any-cast', relPath)) {\n        continue;\n      }\n\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-any-cast',\n        nivel: 'erro',\n        mensagem: mensagemCompleta,\n        relPath,\n        linha,\n        contexto: lineContext,\n      });\n    }\n\n    // Detectar uso de unknown\n    const unknownPattern = /:\\s*unknown\\b/g;\n    let unknownMatch: RegExpMatchArray | null;\n\n    while ((unknownMatch = unknownPattern.exec(src)) !== null) {\n      const position = unknownMatch.index || 0;\n\n      // Pular se estiver em string ou coment√°rio\n      if (isInStringOrComment(src, position)) {\n        continue;\n      }\n\n      // Pular se unknown est√° em contexto gen√©rico apropriado (valida√ß√£o b√°sica)\n      if (isUnknownInGenericContext(src, position)) {\n        continue;\n      }\n\n      // An√°lise contextual inteligente\n      const linha = src.substring(0, position).split('\\n').length;\n      const lineContext = src.split('\\n')[linha - 1]?.trim() || '';\n      const categorizacao = categorizarUnknown(\n        src,\n        fullPath || relPath,\n        lineContext,\n      );\n\n      // Extrair nome da vari√°vel\n      const varName = extractVariableName(unknownMatch, src);\n\n      // Construir mensagem baseada na categoriza√ß√£o\n      let mensagem = '';\n      let nivel: 'info' | 'aviso' | 'erro' = 'info';\n\n      if (categorizacao.categoria === 'legitimo') {\n        // Leg√≠timo com alta confian√ßa (>=95%) - PULAR completamente\n        if (categorizacao.confianca >= 95) {\n          continue;\n        }\n\n        // Leg√≠timo com confian√ßa moderada (85-94%) - info apenas\n        mensagem = varName\n          ? `Tipo 'unknown' em '${varName}': ${categorizacao.motivo}`\n          : `Tipo 'unknown': ${categorizacao.motivo}`;\n        nivel = 'info';\n\n        // Se tem sugest√£o, adicionar\n        if (categorizacao.sugestao) {\n          mensagem += ` | üí° ${categorizacao.sugestao}`;\n        }\n      } else if (categorizacao.categoria === 'melhoravel') {\n        // Melhor√°vel - aviso com sugest√£o\n        nivel = 'aviso';\n        mensagem = varName\n          ? `Tipo 'unknown' em '${varName}' pode ser melhorado (${categorizacao.confianca}% confian√ßa)`\n          : `Tipo 'unknown' pode ser melhorado (${categorizacao.confianca}% confian√ßa)`;\n\n        mensagem += ` | ${categorizacao.motivo}`;\n\n        if (categorizacao.sugestao) {\n          mensagem += ` | üí° ${categorizacao.sugestao}`;\n        } else {\n          mensagem += ` | üí° Revisar uso para inferir tipo mais espec√≠fico`;\n        }\n\n        mensagem += ` | ‚ö†Ô∏è  Revis√£o manual recomendada`;\n      } else {\n        // Corrigir - erro que deve ser tratado\n        nivel = 'erro';\n        mensagem = varName\n          ? `Tipo 'unknown' em '${varName}' deve ser corrigido (${categorizacao.confianca}% confian√ßa)`\n          : `Tipo 'unknown' deve ser corrigido (${categorizacao.confianca}% confian√ßa)`;\n\n        mensagem += ` | ${categorizacao.motivo}`;\n\n        if (categorizacao.sugestao) {\n          mensagem += ` | ‚úèÔ∏è  ${categorizacao.sugestao}`;\n        }\n\n        mensagem += ` | üîç Revis√£o manual obrigat√≥ria`;\n      }\n\n      // Verifica se regra est√° suprimida para este arquivo\n      if (shouldSuppressOccurrence('tipo-inseguro-unknown', relPath)) {\n        continue;\n      }\n\n      ocorrencias.push({\n        tipo: 'tipo-inseguro-unknown',\n        nivel,\n        mensagem,\n        relPath,\n        linha,\n        contexto: lineContext,\n      });\n    }\n\n    return ocorrencias;\n  },\n};\n\nexport default ANALISTA;\n"]}