{"version":3,"file":"detector-arquitetura.js","sourceRoot":"","sources":["../../../src/analistas/detectores/detector-arquitetura.ts"],"names":[],"mappings":"AAUA,OAAO,EAAE,QAAQ,EAAE,MAAM,0BAA0B,CAAC;AACpD,OAAO,EAAE,2BAA2B,EAAE,MAAM,2DAA2D,CAAC;AACxG,OAAO,KAAK,IAAI,MAAM,MAAM,CAAC;AAW7B,OAAO,EAAE,eAAe,EAAE,MAAM,GAAG,CAAC;AAEpC,MAAM,CAAC,MAAM,mBAAmB,GAAa;IAC3C,IAAI,EAAE,aAAa;IACnB,SAAS,EAAE,WAAW;IACtB,SAAS,EAAE,6DAA6D;IAExE,IAAI,EAAE,CAAC,OAAe,EAAW,EAAE;QACjC,OAAO,4BAA4B,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACpD,CAAC;IAED,OAAO,EAAE,KAAK,EACZ,GAAW,EACX,OAAe,EACf,GAA0B,EAC1B,QAAiB,EACjB,QAA2B,EACJ,EAAE;QACzB,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YAC9B,OAAO,EAAE,CAAC;QACZ,CAAC;QAED,IAAI,CAAC;YAEH,MAAM,mBAAmB,GAAG,eAAe,CAAC,GAAG,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;YAG/D,IAAI,eAAgD,CAAC;YACrD,MAAM,WAAW,GAAiB,EAAE,CAAC;YACrC,IAAI,CAAC;gBACH,eAAe,GAAG,MAAM,2BAA2B,CACjD,QAAQ,EACR,mBAAmB,CACpB,CAAC;YACJ,CAAC;YAAC,OAAO,IAAI,EAAE,CAAC;gBAEd,OAAO;oBACL,eAAe,CAAC;wBACd,IAAI,EAAE,cAAc;wBACpB,KAAK,EAAE,OAAO;wBACd,QAAQ,EAAE,2BAA2B,CAAC,uBAAuB,CAAC,IAAI,CAAC;wBACnE,OAAO;wBACP,KAAK,EAAE,CAAC;qBACT,CAAC;iBACH,CAAC;YACJ,CAAC;YAGD,WAAW,CAAC,IAAI,CACd,eAAe,CAAC;gBACd,IAAI,EAAE,qBAAqB;gBAC3B,KAAK,EACH,CAAC,eAAe,CAAC,SAAS,EAAE,MAAM,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM;gBACjE,QAAQ,EAAE,2BAA2B,CAAC,kBAAkB,CACtD,eAAe,CAAC,kBAAkB,EAClC,eAAe,CAAC,SAAS,IAAI,CAAC,CAC/B;gBACD,OAAO;gBACP,KAAK,EAAE,CAAC;aACT,CAAC,CACH,CAAC;YAGF,IAAI,CAAC,eAAe,CAAC,eAAe,EAAE,MAAM,IAAI,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC;gBACvD,WAAW,CAAC,IAAI,CACd,eAAe,CAAC;oBACd,IAAI,EAAE,6BAA6B;oBACnC,KAAK,EAAE,MAAM;oBACb,QAAQ,EAAE,2BAA2B,CAAC,eAAe,CACnD,eAAe,CAAC,eAAe,IAAI,EAAE,CACtC;oBACD,OAAO;oBACP,KAAK,EAAE,CAAC;iBACT,CAAC,CACH,CAAC;YACJ,CAAC;YAGD,KAAK,MAAM,QAAQ,IAAI,CAAC,eAAe,CAAC,SAAS,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC;gBACrE,WAAW,CAAC,IAAI,CACd,eAAe,CAAC;oBACd,IAAI,EAAE,sBAAsB;oBAC5B,KAAK,EAAE,OAAO;oBACd,QAAQ,EAAE,2BAA2B,CAAC,QAAQ,CAAC,QAAQ,CAAC;oBACxD,OAAO;oBACP,KAAK,EAAE,CAAC;iBACT,CAAC,CACH,CAAC;YACJ,CAAC;YAGD,MAAM,QAAQ,GAAG,eAAe,CAAC,QAAQ,CAAC;YAC1C,IACE,QAAQ;gBACR,OAAO,QAAQ,KAAK,QAAQ;gBAC5B,aAAa,IAAI,QAAQ;gBACzB,QAAQ,IAAI,QAAQ,EACpB,CAAC;gBACD,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,CAAC,CAAC,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,CAAC,GAAG,GAAG,EAAE,CAAC;oBACtE,WAAW,CAAC,IAAI,CACd,eAAe,CAAC;wBACd,IAAI,EAAE,sBAAsB;wBAC5B,KAAK,EAAE,OAAO;wBACd,QAAQ,EAAE,2BAA2B,CAAC,QAAQ,CAC5C,QAAQ,CAAC,WAAW,IAAI,CAAC,EACzB,QAAQ,CAAC,MAAM,IAAI,CAAC,CACrB;wBACD,OAAO;wBACP,KAAK,EAAE,CAAC;qBACT,CAAC,CACH,CAAC;gBACJ,CAAC;YACH,CAAC;YAED,OAAO,WAAW,CAAC;QACrB,CAAC;QAAC,OAAO,IAAI,EAAE,CAAC;YACd,OAAO;gBACL,eAAe,CAAC;oBACd,IAAI,EAAE,cAAc;oBACpB,KAAK,EAAE,OAAO;oBACd,QAAQ,EAAE,2BAA2B,CAAC,uBAAuB,CAAC,IAAI,CAAC;oBACnE,OAAO;oBACP,KAAK,EAAE,CAAC;iBACT,CAAC;aACH,CAAC;QACJ,CAAC;IACH,CAAC;CACF,CAAC;AAEF,SAAS,eAAe,CACtB,GAAmB,EACnB,OAAe,EACf,IAAY;IAEZ,MAAM,OAAO,GAAiB,EAAE,CAAC;IACjC,MAAM,OAAO,GAAiB,EAAE,CAAC;IACjC,MAAM,oBAAoB,GAAa,EAAE,CAAC;IAC1C,MAAM,oBAAoB,GAAa,EAAE,CAAC;IAC1C,MAAM,OAAO,GAA2B,EAAE,CAAC;IAC3C,IAAI,YAAY,GAAG,CAAC,CAAC;IAErB,QAAQ,CAAC,GAAG,CAAC,IAAI,EAAE;QACjB,iBAAiB,CAAC,IAAiC;YACjD,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;YACtC,MAAM,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CACpC,CACE,IAG4B,EAC5B,EAAE;gBAEF,IAAI,IAAI,CAAC,IAAI,KAAK,wBAAwB;oBAAE,OAAO,SAAS,CAAC;gBAC7D,IAAI,IAAI,CAAC,IAAI,KAAK,0BAA0B;oBAAE,OAAO,GAAG,CAAC;gBACzD,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;YACzB,CAAC,CACF,CAAC;YAEF,IAAI,IAAI,GAAuB,UAAU,CAAC;YAE1C,IAAI,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;gBAC3B,IAAI,GAAG,OAAO,CAAC;gBACf,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBACnC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;gBAC3C,oBAAoB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpC,CAAC;iBAAM,IAAI,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;gBAClC,IAAI,GAAG,UAAU,CAAC;gBAClB,oBAAoB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpC,CAAC;iBAAM,CAAC;gBACN,oBAAoB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpC,CAAC;YAED,OAAO,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;QACxC,CAAC;QAED,sBAAsB,CAAC,IAAsC;YAC3D,IAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;gBAE1B,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;gBACnC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC,EAAE,IAAI,MAAM,IAAI,IAAI,CAAC,EAAE,EAAE,CAAC;oBACjD,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,IAAc,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;gBAChE,CAAC;qBAAM,IAAI,cAAc,IAAI,IAAI,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;oBAEvD,KAAK,MAAM,UAAU,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;wBAC3C,IAAI,UAAU,CAAC,EAAE,IAAI,MAAM,IAAI,UAAU,CAAC,EAAE,EAAE,CAAC;4BAC7C,OAAO,CAAC,IAAI,CAAC;gCACX,IAAI,EAAE,UAAU,CAAC,EAAE,CAAC,IAAc;gCAClC,IAAI,EAAE,OAAO;6BACd,CAAC,CAAC;wBACL,CAAC;oBACH,CAAC;gBACH,CAAC;YACH,CAAC;iBAAM,CAAC;gBAEN,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;oBAExC,MAAM,IAAI,GACR,UAAU,IAAI,IAAI;wBAClB,IAAI,CAAC,QAAQ,CAAC,IAAI,KAAK,YAAY;wBACnC,MAAM,IAAI,IAAI,CAAC,QAAQ;wBACrB,CAAC,CAAE,IAAI,CAAC,QAAQ,CAAC,IAAe;wBAChC,CAAC,CAAC,UAAU,CAAC;oBACjB,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;gBAC9C,CAAC;YACH,CAAC;QACH,CAAC;QAED,wBAAwB;YACtB,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;QACrD,CAAC;QAGD,iFAAiF;YAC/E,YAAY,EAAE,CAAC;QACjB,CAAC;QAED,yCAAyC;YACvC,YAAY,EAAE,CAAC;QACjB,CAAC;KACF,CAAC,CAAC;IAEH,OAAO;QACL,OAAO,EAAE,OAAO;QAChB,OAAO;QACP,OAAO;QACP,oBAAoB;QACpB,oBAAoB;QACpB,OAAO;QACP,YAAY,EAAE,YAAY,IAAI,CAAC;KAChC,CAAC;AACJ,CAAC;AAED,KAAK,UAAU,2BAA2B,CACxC,QAA0B,EAC1B,YAAiC;IAGjC,MAAM,iBAAiB,GAA0B,EAAE,CAAC;IAEpD,KAAK,MAAM,OAAO,IAAI,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC;QAErD,IACE,OAAO,CAAC,GAAG;YACX,OAAO,CAAC,OAAO;YACf,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,oBAAoB,CAAC,EAC3C,CAAC;YAED,IAAI,QAAQ,IAAI,OAAO,CAAC,GAAG,IAAI,MAAM,IAAI,OAAO,CAAC,GAAG,EAAE,CAAC;gBACrD,MAAM,KAAK,GAAG,eAAe,CAC3B,OAAO,CAAC,GAAqB,EAC7B,OAAO,CAAC,OAAO,EACf,OAAO,CAAC,OAAO,CAChB,CAAC;gBACF,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAChC,CAAC;QACH,CAAC;IACH,CAAC;IAED,iBAAiB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IAGrC,MAAM,eAAe,GAAG,0BAA0B,CAAC,iBAAiB,CAAC,CAAC;IAGtE,MAAM,QAAQ,GAAG,gBAAgB,CAAC,iBAAiB,CAAC,CAAC;IAGrD,MAAM,SAAS,GAAG,iBAAiB,CAAC,iBAAiB,EAAE,eAAe,CAAC,CAAC;IAGxE,MAAM,eAAe,GAAG,oBAAoB,CAAC,iBAAiB,CAAC,CAAC;IAEhE,OAAO;QACL,kBAAkB,EAAE,eAAe,CAAC,IAAI;QACxC,SAAS,EAAE,eAAe,CAAC,SAAS;QACpC,eAAe;QACf,SAAS;QACT,aAAa,EAAE,EAAE;QACjB,QAAQ;QACR,OAAO,EAAE,EAAE;QACX,OAAO,EAAE,EAAE;QACX,KAAK,EAAE,YAAY;KACpB,CAAC;AACJ,CAAC;AAED,SAAS,0BAA0B,CAAC,YAAmC;IAIrE,MAAM,OAAO,GAAG,IAAI,GAAG,EAAU,CAAC;IAClC,IAAI,SAAS,GAAG,KAAK,CAAC;IACtB,IAAI,YAAY,GAAG,KAAK,CAAC;IACzB,IAAI,OAAO,GAAG,KAAK,CAAC;IACpB,IAAI,SAAS,GAAG,KAAK,CAAC;IACtB,IAAI,QAAQ,GAAG,KAAK,CAAC;IAGrB,KAAK,MAAM,KAAK,IAAI,YAAY,EAAE,CAAC;QACjC,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;YAClB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;YAElE,IAAI,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;gBAAE,SAAS,GAAG,IAAI,CAAC;YAC/C,IAAI,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC;gBAAE,YAAY,GAAG,IAAI,CAAC;YACrD,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC;gBAAE,OAAO,GAAG,IAAI,CAAC;YAC1C,IAAI,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;gBAAE,SAAS,GAAG,IAAI,CAAC;YAC/C,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC;gBAAE,QAAQ,GAAG,IAAI,CAAC;QAC/C,CAAC;IACH,CAAC;IAGD,MAAM,yBAAyB,GAC7B,8BAA8B,CAAC,YAAY,CAAC,CAAC;IAG/C,IAAI,SAAS,IAAI,YAAY,IAAI,CAAC,yBAAyB,EAAE,CAAC;QAC5D,IAAI,SAAS,IAAI,QAAQ,EAAE,CAAC;YAC1B,OAAO;gBACL,IAAI,EAAE,8CAA8C;gBACpD,SAAS,EAAE,EAAE;aACd,CAAC;QACJ,CAAC;QACD,OAAO;YACL,IAAI,EAAE,4CAA4C;YAClD,SAAS,EAAE,EAAE;SACd,CAAC;IACJ,CAAC;IAED,IAAI,OAAO,CAAC,IAAI,IAAI,CAAC,IAAI,QAAQ,EAAE,CAAC;QAClC,OAAO,EAAE,IAAI,EAAE,qCAAqC,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC;IACxE,CAAC;IAED,IAAI,OAAO,CAAC,IAAI,IAAI,CAAC,EAAE,CAAC;QACtB,OAAO,EAAE,IAAI,EAAE,qBAAqB,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC;IACxD,CAAC;IAED,IAAI,yBAAyB,EAAE,CAAC;QAC9B,OAAO,EAAE,IAAI,EAAE,0CAA0C,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC;IAC7E,CAAC;IAED,OAAO,EAAE,IAAI,EAAE,mCAAmC,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC;AACtE,CAAC;AAED,SAAS,gBAAgB,CACvB,YAAmC;IAEnC,IAAI,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QAC9B,OAAO,EAAE,YAAY,EAAE,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,iBAAiB,EAAE,CAAC,EAAE,CAAC;IAC9E,CAAC;IAGD,MAAM,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QAClD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YAC7B,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;QAChC,CAAC;aAAM,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,QAAQ,EAAE,CAAC;YACzC,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC;QACzB,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,MAAM,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QAClD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YAC7B,OAAO,CACL,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAa,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC,CAAC,MAAM,CACrE,CAAC;QACJ,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,MAAM,YAAY,GAAG,YAAY,GAAG,CAAC,CAAC,CAAC,CAAC,YAAY,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;IAGxE,MAAM,SAAS,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QAC/C,MAAM,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,MAAM,IAAI,CAAC,CAAC;QACrD,MAAM,QAAQ,GAAG,CAAC,CAAC,oBAAoB,EAAE,MAAM,IAAI,CAAC,CAAC;QACrD,OAAO,GAAG,GAAG,QAAQ,GAAG,QAAQ,CAAC;IACnC,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,MAAM,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QAClD,OAAO,GAAG,GAAG,CAAC,CAAC,CAAC,oBAAoB,EAAE,MAAM,IAAI,CAAC,CAAC,CAAC;IACrD,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,MAAM,WAAW,GAAG,SAAS,GAAG,CAAC,CAAC,CAAC,CAAC,YAAY,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;IAGjE,MAAM,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QAClD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YAC7B,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;QAChC,CAAC;aAAM,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,QAAQ,EAAE,CAAC;YACzC,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC;QACzB,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,MAAM,MAAM,GACV,YAAY,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,YAAY,GAAG,YAAY,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAGlE,MAAM,iBAAiB,GACrB,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,YAAY,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;QAC/D,YAAY,CAAC,MAAM,CAAC;IAEtB,OAAO;QACL,YAAY,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,YAAY,CAAC,CAAC;QACpD,WAAW,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC;QAClD,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;QACxC,iBAAiB;KAClB,CAAC;AACJ,CAAC;AAED,SAAS,iBAAiB,CACxB,YAAmC,EACnC,OAA4C;IAE5C,MAAM,SAAS,GAAa,EAAE,CAAC;IAG/B,MAAM,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QAClD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YAC7B,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;QAChC,CAAC;aAAM,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,QAAQ,EAAE,CAAC;YACzC,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC;QACzB,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,MAAM,gBAAgB,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QACtD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YAC7B,OAAO,CACL,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAa,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,UAAU,CAAC,CAAC,MAAM,CACxE,CAAC;QACJ,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,IAAI,YAAY,GAAG,CAAC,IAAI,gBAAgB,GAAG,YAAY,GAAG,GAAG,EAAE,CAAC;QAC9D,SAAS,CAAC,IAAI,CAAC,2CAA2C,CAAC,CAAC;IAC9D,CAAC;IAGD,KAAK,MAAM,KAAK,IAAI,YAAY,EAAE,CAAC;QACjC,MAAM,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC;YAC/C,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM;YACtB,CAAC,CAAC,OAAO,KAAK,CAAC,OAAO,KAAK,QAAQ;gBACjC,CAAC,CAAC,KAAK,CAAC,OAAO;gBACf,CAAC,CAAC,CAAC,CAAC;QAER,IAAI,YAAY,GAAG,EAAE,EAAE,CAAC;YACtB,MAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,sBAAsB,CAAC;YACxD,SAAS,CAAC,IAAI,CACZ,WAAW,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,6BAA6B,YAAY,GAAG,CAC9E,CAAC;QACJ,CAAC;IACH,CAAC;IAED,OAAO,SAAS,CAAC;AACnB,CAAC;AAED,SAAS,oBAAoB,CAAC,YAAmC;IAC/D,MAAM,eAAe,GAAa,EAAE,CAAC;IAErC,MAAM,OAAO,GAAG,IAAI,GAAG,EAAU,CAAC;IAClC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE;QACzB,IAAI,CAAC,CAAC,OAAO,EAAE,CAAC;YACd,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACxD,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,IAAI,OAAO,CAAC,IAAI,GAAG,CAAC,EAAE,CAAC;QACrB,eAAe,CAAC,IAAI,CAAC,UAAU,OAAO,CAAC,IAAI,wBAAwB,CAAC,CAAC;IACvE,CAAC;IAED,MAAM,iBAAiB,GACrB,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,YAAY,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;QAC/D,YAAY,CAAC,MAAM,CAAC;IACtB,eAAe,CAAC,IAAI,CAAC,uBAAuB,iBAAiB,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IAE5E,MAAM,YAAY,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;QAClD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;YAC7B,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;QAChC,CAAC;aAAM,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,QAAQ,EAAE,CAAC;YACzC,OAAO,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC;QACzB,CAAC;QACD,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,CAAC,CAAC,CAAC;IAEN,eAAe,CAAC,IAAI,CAAC,GAAG,YAAY,mBAAmB,CAAC,CAAC;IAEzD,OAAO,eAAe,CAAC;AACzB,CAAC;AAED,SAAS,8BAA8B,CACrC,YAAmC;IAGnC,MAAM,YAAY,GAAG,IAAI,GAAG,EAAuB,CAAC;IAEpD,KAAK,MAAM,KAAK,IAAI,YAAY,EAAE,CAAC;QACjC,MAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,sBAAsB,CAAC;QACxD,MAAM,IAAI,GAAG,IAAI,GAAG,EAAU,CAAC;QAC/B,IAAI,KAAK,CAAC,oBAAoB,EAAE,CAAC;YAC/B,KAAK,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;QAC7D,CAAC;QACD,YAAY,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAClC,CAAC;IAGD,KAAK,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,YAAY,EAAE,CAAC;QAC3C,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE,CAAC;YACvB,MAAM,YAAY,GAAG,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAC3C,IAAI,YAAY,EAAE,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC;gBAC/B,OAAO,IAAI,CAAC;YACd,CAAC;QACH,CAAC;IACH,CAAC;IAED,OAAO,KAAK,CAAC;AACf,CAAC","sourcesContent":["// SPDX-License-Identifier: MIT\nimport type { NodePath } from '/traverse';\nimport type {\n  ExportNamedDeclaration,\n  ImportDeclaration,\n  ImportDefaultSpecifier,\n  ImportNamespaceSpecifier,\n  ImportSpecifier,\n  Node,\n} from '/types';\nimport { traverse } from '/config/traverse.js';\nimport { DetectorArquiteturaMessages } from '/messages/analistas/detector-arquitetura-messages.js';\nimport * as path from 'path';\n\nimport type {\n  AnaliseArquitetural,\n  Analista,\n  ContextoExecucao,\n  EstatisticasArquivo,\n  ExportInfo,\n  ImportInfo,\n  Ocorrencia,\n} from '@';\nimport { criarOcorrencia } from '@';\n\nexport const analistaArquitetura: Analista = {\n  nome: 'arquitetura',\n  categoria: 'estrutura',\n  descricao: 'Analisa padrões arquiteturais e detecta violações de design',\n\n  test: (relPath: string): boolean => {\n    return /\\.(js|jsx|ts|tsx|mjs|cjs)$/.test(relPath);\n  },\n\n  aplicar: async (\n    src: string,\n    relPath: string,\n    ast: NodePath<Node> | null,\n    fullPath?: string,\n    contexto?: ContextoExecucao,\n  ): Promise<Ocorrencia[]> => {\n    if (!ast || !src || !contexto) {\n      return [];\n    }\n\n    try {\n      // Analisar arquivo atual\n      const estatisticasArquivo = analisarArquivo(ast, relPath, src);\n\n      // Analisar todo o contexto para entender a arquitetura\n      let analiseCompleta: AnaliseArquitetural | undefined;\n      const ocorrencias: Ocorrencia[] = [];\n      try {\n        analiseCompleta = await analisarArquiteturaCompleta(\n          contexto,\n          estatisticasArquivo,\n        );\n      } catch (erro) {\n        // Em caso de falha na análise contextual, registre ocorrência e continue sem travar\n        return [\n          criarOcorrencia({\n            tipo: 'erro-analise',\n            nivel: 'aviso',\n            mensagem: DetectorArquiteturaMessages.erroAnalisarArquitetura(erro),\n            relPath,\n            linha: 1,\n          }),\n        ];\n      }\n\n      // Relatório principal da arquitetura\n      ocorrencias.push(\n        criarOcorrencia({\n          tipo: 'analise-arquitetura',\n          nivel:\n            (analiseCompleta.violacoes?.length ?? 0) > 0 ? 'aviso' : 'info',\n          mensagem: DetectorArquiteturaMessages.padraoArquitetural(\n            analiseCompleta.padraoIdentificado,\n            analiseCompleta.confianca ?? 0,\n          ),\n          relPath,\n          linha: 1,\n        }),\n      );\n\n      // Relatório de características\n      if ((analiseCompleta.caracteristicas?.length ?? 0) > 0) {\n        ocorrencias.push(\n          criarOcorrencia({\n            tipo: 'caracteristicas-arquitetura',\n            nivel: 'info',\n            mensagem: DetectorArquiteturaMessages.caracteristicas(\n              analiseCompleta.caracteristicas || [],\n            ),\n            relPath,\n            linha: 1,\n          }),\n        );\n      }\n\n      // Relatório de violações\n      for (const violacao of (analiseCompleta.violacoes ?? []).slice(0, 3)) {\n        ocorrencias.push(\n          criarOcorrencia({\n            tipo: 'violacao-arquitetura',\n            nivel: 'aviso',\n            mensagem: DetectorArquiteturaMessages.violacao(violacao),\n            relPath,\n            linha: 1,\n          }),\n        );\n      }\n\n      // Métricas de qualidade\n      const metricas = analiseCompleta.metricas;\n      if (\n        metricas &&\n        typeof metricas === 'object' &&\n        'acoplamento' in metricas &&\n        'coesao' in metricas\n      ) {\n        if ((metricas.acoplamento ?? 0) > 0.7 || (metricas.coesao ?? 1) < 0.3) {\n          ocorrencias.push(\n            criarOcorrencia({\n              tipo: 'metricas-arquitetura',\n              nivel: 'aviso',\n              mensagem: DetectorArquiteturaMessages.metricas(\n                metricas.acoplamento ?? 0,\n                metricas.coesao ?? 0,\n              ),\n              relPath,\n              linha: 1,\n            }),\n          );\n        }\n      }\n\n      return ocorrencias;\n    } catch (erro) {\n      return [\n        criarOcorrencia({\n          tipo: 'erro-analise',\n          nivel: 'aviso',\n          mensagem: DetectorArquiteturaMessages.erroAnalisarArquitetura(erro),\n          relPath,\n          linha: 1,\n        }),\n      ];\n    }\n  },\n};\n\nfunction analisarArquivo(\n  ast: NodePath<Node>,\n  relPath: string,\n  _src: string,\n): EstatisticasArquivo {\n  const imports: ImportInfo[] = [];\n  const exports: ExportInfo[] = [];\n  const dependenciasExternas: string[] = [];\n  const dependenciasInternas: string[] = [];\n  const aliases: Record<string, number> = {};\n  let complexidade = 0;\n\n  traverse(ast.node, {\n    ImportDeclaration(path: NodePath<ImportDeclaration>) {\n      const origem = path.node.source.value;\n      const items = path.node.specifiers.map(\n        (\n          spec:\n            | ImportSpecifier\n            | ImportDefaultSpecifier\n            | ImportNamespaceSpecifier,\n        ) => {\n          // Mixed import specifier types\n          if (spec.type === 'ImportDefaultSpecifier') return 'default';\n          if (spec.type === 'ImportNamespaceSpecifier') return '*';\n          return spec.local.name;\n        },\n      );\n\n      let tipo: ImportInfo['tipo'] = 'external';\n\n      if (origem.startsWith('@')) {\n        tipo = 'alias';\n        const alias = origem.split('/')[0];\n        aliases[alias] = (aliases[alias] || 0) + 1;\n        dependenciasInternas.push(origem);\n      } else if (origem.startsWith('.')) {\n        tipo = 'relative';\n        dependenciasInternas.push(origem);\n      } else {\n        dependenciasExternas.push(origem);\n      }\n\n      imports.push({ origem, tipo, items });\n    },\n\n    ExportNamedDeclaration(path: NodePath<ExportNamedDeclaration>) {\n      if (path.node.declaration) {\n        // export const/function/class/etc\n        const decl = path.node.declaration; // ExportDeclaration node\n        if ('id' in decl && decl.id && 'name' in decl.id) {\n          exports.push({ nome: decl.id.name as string, tipo: 'named' });\n        } else if ('declarations' in decl && decl.declarations) {\n          // export const a = ..., b = ...\n          for (const declarator of decl.declarations) {\n            if (declarator.id && 'name' in declarator.id) {\n              exports.push({\n                nome: declarator.id.name as string,\n                tipo: 'named',\n              });\n            }\n          }\n        }\n      } else {\n        // export { a, b }\n        for (const spec of path.node.specifiers) {\n          // ExportSpecifier nodes\n          const name =\n            'exported' in spec &&\n            spec.exported.type === 'Identifier' &&\n            'name' in spec.exported\n              ? (spec.exported.name as string)\n              : 'exported';\n          exports.push({ nome: name, tipo: 'named' });\n        }\n      }\n    },\n\n    ExportDefaultDeclaration() {\n      exports.push({ nome: 'default', tipo: 'default' });\n    },\n\n    // Calcular complexidade ciclomática básica\n    'IfStatement|WhileStatement|ForStatement|DoWhileStatement|SwitchCase|CatchClause'() {\n      complexidade++;\n    },\n\n    'ConditionalExpression|LogicalExpression'() {\n      complexidade++;\n    },\n  });\n\n  return {\n    caminho: relPath,\n    imports,\n    exports,\n    dependenciasExternas,\n    dependenciasInternas,\n    aliases,\n    complexidade: complexidade || 1,\n  };\n}\n\nasync function analisarArquiteturaCompleta(\n  contexto: ContextoExecucao,\n  arquivoAtual: EstatisticasArquivo,\n): Promise<AnaliseArquitetural> {\n  // Analisar todos os arquivos para entender a arquitetura geral\n  const todasEstatisticas: EstatisticasArquivo[] = [];\n\n  for (const arquivo of contexto.arquivos.slice(0, 50)) {\n    // Limitar para performance\n    if (\n      arquivo.ast &&\n      arquivo.content &&\n      arquivo.relPath.match(/\\.(js|jsx|ts|tsx)$/)\n    ) {\n      // Verificar se o AST é do tipo correto (NodePath<Node>)\n      if ('parent' in arquivo.ast && 'node' in arquivo.ast) {\n        const stats = analisarArquivo(\n          arquivo.ast as NodePath<Node>,\n          arquivo.relPath,\n          arquivo.content,\n        );\n        todasEstatisticas.push(stats);\n      }\n    }\n  }\n\n  todasEstatisticas.push(arquivoAtual);\n\n  // Detectar padrão arquitetural\n  const padraoDetectado = detectarPadraoArquitetural(todasEstatisticas);\n\n  // Calcular métricas\n  const metricas = calcularMetricas(todasEstatisticas);\n\n  // Detectar violações\n  const violacoes = detectarViolacoes(todasEstatisticas, padraoDetectado);\n\n  // Gerar características\n  const caracteristicas = gerarCaracteristicas(todasEstatisticas);\n\n  return {\n    padraoIdentificado: padraoDetectado.tipo,\n    confianca: padraoDetectado.confianca,\n    caracteristicas,\n    violacoes,\n    recomendacoes: [],\n    metricas,\n    imports: [], // Propriedade obrigatória do tipo AnaliseArquitetural\n    exports: [], // Propriedade obrigatória do tipo AnaliseArquitetural\n    stats: arquivoAtual, // Propriedade obrigatória do tipo AnaliseArquitetural\n  };\n}\n\nfunction detectarPadraoArquitetural(estatisticas: EstatisticasArquivo[]): {\n  tipo: string;\n  confianca: number;\n} {\n  const aliases = new Set<string>();\n  let temNucleo = false;\n  let temAnalistas = false;\n  let _temCLI = false;\n  let temShared = false;\n  let temTipos = false;\n\n  // Analisar uso de aliases\n  for (const stats of estatisticas) {\n    if (stats.aliases) {\n      Object.keys(stats.aliases).forEach((alias) => aliases.add(alias));\n\n      if (stats.aliases['']) temNucleo = true;\n      if (stats.aliases['']) temAnalistas = true;\n      if (stats.aliases['']) _temCLI = true;\n      if (stats.aliases['']) temShared = true;\n      if (stats.aliases['']) temTipos = true;\n    }\n  }\n\n  // Detectar dependências circulares\n  const temDependenciasCirculares =\n    detectarDependenciasCirculares(estatisticas);\n\n  // Regras de detecção\n  if (temNucleo && temAnalistas && !temDependenciasCirculares) {\n    if (temShared && temTipos) {\n      return {\n        tipo: 'Arquitetura Hexagonal com Clean Architecture',\n        confianca: 90,\n      };\n    }\n    return {\n      tipo: 'Arquitetura Hexagonal (Ports and Adapters)',\n      confianca: 85,\n    };\n  }\n\n  if (aliases.size >= 4 && temTipos) {\n    return { tipo: 'Arquitetura Modular Bem Estruturada', confianca: 80 };\n  }\n\n  if (aliases.size >= 2) {\n    return { tipo: 'Arquitetura Modular', confianca: 70 };\n  }\n\n  if (temDependenciasCirculares) {\n    return { tipo: 'Arquitetura com Problemas de Acoplamento', confianca: 60 };\n  }\n\n  return { tipo: 'Arquitetura Simples ou Monolítica', confianca: 50 };\n}\n\nfunction calcularMetricas(\n  estatisticas: EstatisticasArquivo[],\n): AnaliseArquitetural['metricas'] {\n  if (estatisticas.length === 0) {\n    return { modularidade: 0, acoplamento: 0, coesao: 0, complexidadeMedia: 0 };\n  }\n\n  // Modularidade = uso de aliases / total de imports\n  const totalImports = estatisticas.reduce((sum, s) => {\n    if (Array.isArray(s.imports)) {\n      return sum + s.imports.length;\n    } else if (typeof s.imports === 'number') {\n      return sum + s.imports;\n    }\n    return sum;\n  }, 0);\n\n  const importsAlias = estatisticas.reduce((sum, s) => {\n    if (Array.isArray(s.imports)) {\n      return (\n        sum + s.imports.filter((i: ImportInfo) => i.tipo === 'alias').length\n      );\n    }\n    return sum;\n  }, 0);\n\n  const modularidade = totalImports > 0 ? importsAlias / totalImports : 0;\n\n  // Acoplamento = dependências externas / total de dependências\n  const totalDeps = estatisticas.reduce((sum, s) => {\n    const externas = s.dependenciasExternas?.length ?? 0;\n    const internas = s.dependenciasInternas?.length ?? 0;\n    return sum + externas + internas;\n  }, 0);\n\n  const depsExternas = estatisticas.reduce((sum, s) => {\n    return sum + (s.dependenciasExternas?.length ?? 0);\n  }, 0);\n\n  const acoplamento = totalDeps > 0 ? depsExternas / totalDeps : 0;\n\n  // Coesão = exports / imports (simplificado)\n  const totalExports = estatisticas.reduce((sum, s) => {\n    if (Array.isArray(s.exports)) {\n      return sum + s.exports.length;\n    } else if (typeof s.exports === 'number') {\n      return sum + s.exports;\n    }\n    return sum;\n  }, 0);\n\n  const coesao =\n    totalImports > 0 ? Math.min(totalExports / totalImports, 1) : 0;\n\n  // Complexidade média\n  const complexidadeMedia =\n    estatisticas.reduce((sum, s) => sum + (s.complexidade ?? 0), 0) /\n    estatisticas.length;\n\n  return {\n    modularidade: Math.max(0, Math.min(1, modularidade)),\n    acoplamento: Math.max(0, Math.min(1, acoplamento)),\n    coesao: Math.max(0, Math.min(1, coesao)),\n    complexidadeMedia,\n  };\n}\n\nfunction detectarViolacoes(\n  estatisticas: EstatisticasArquivo[],\n  _padrao: { tipo: string; confianca: number },\n): string[] {\n  const violacoes: string[] = [];\n\n  // Detectar imports relativos excessivos\n  const totalImports = estatisticas.reduce((sum, s) => {\n    if (Array.isArray(s.imports)) {\n      return sum + s.imports.length;\n    } else if (typeof s.imports === 'number') {\n      return sum + s.imports;\n    }\n    return sum;\n  }, 0);\n\n  const importsRelativos = estatisticas.reduce((sum, s) => {\n    if (Array.isArray(s.imports)) {\n      return (\n        sum + s.imports.filter((i: ImportInfo) => i.tipo === 'relative').length\n      );\n    }\n    return sum;\n  }, 0);\n\n  if (totalImports > 0 && importsRelativos / totalImports > 0.3) {\n    violacoes.push('Uso excessivo de imports relativos (>30%)');\n  }\n\n  // Detectar arquivos com muitas dependências\n  for (const stats of estatisticas) {\n    const importsCount = Array.isArray(stats.imports)\n      ? stats.imports.length\n      : typeof stats.imports === 'number'\n        ? stats.imports\n        : 0;\n\n    if (importsCount > 20) {\n      const caminho = stats.caminho ?? 'arquivo-desconhecido';\n      violacoes.push(\n        `Arquivo ${path.basename(caminho)} com muitas dependências (${importsCount})`,\n      );\n    }\n  }\n\n  return violacoes;\n}\n\nfunction gerarCaracteristicas(estatisticas: EstatisticasArquivo[]): string[] {\n  const caracteristicas: string[] = [];\n\n  const aliases = new Set<string>();\n  estatisticas.forEach((s) => {\n    if (s.aliases) {\n      Object.keys(s.aliases).forEach((a) => aliases.add(a));\n    }\n  });\n\n  if (aliases.size > 0) {\n    caracteristicas.push(`Uso de ${aliases.size} aliases de importação`);\n  }\n\n  const mediaComplexidade =\n    estatisticas.reduce((sum, s) => sum + (s.complexidade ?? 0), 0) /\n    estatisticas.length;\n  caracteristicas.push(`Complexidade média: ${mediaComplexidade.toFixed(1)}`);\n\n  const totalExports = estatisticas.reduce((sum, s) => {\n    if (Array.isArray(s.exports)) {\n      return sum + s.exports.length;\n    } else if (typeof s.exports === 'number') {\n      return sum + s.exports;\n    }\n    return sum;\n  }, 0);\n\n  caracteristicas.push(`${totalExports} exports públicos`);\n\n  return caracteristicas;\n}\n\nfunction detectarDependenciasCirculares(\n  estatisticas: EstatisticasArquivo[],\n): boolean {\n  // Simplificado: detectar se há imports bidirecionais\n  const dependencias = new Map<string, Set<string>>();\n\n  for (const stats of estatisticas) {\n    const caminho = stats.caminho ?? 'arquivo-desconhecido';\n    const deps = new Set<string>();\n    if (stats.dependenciasInternas) {\n      stats.dependenciasInternas.forEach((dep) => deps.add(dep));\n    }\n    dependencias.set(caminho, deps);\n  }\n\n  // Verificar ciclos simples (A -> B -> A)\n  for (const [arquivo, deps] of dependencias) {\n    for (const dep of deps) {\n      const depsDoDepdep = dependencias.get(dep);\n      if (depsDoDepdep?.has(arquivo)) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n"]}