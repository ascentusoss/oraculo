{"version":3,"file":"exec-safe.js","sourceRoot":"","sources":["../../../src/core/utils/exec-safe.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,QAAQ,EAAwB,MAAM,oBAAoB,CAAC;AAEpE,OAAO,EAAE,MAAM,EAAE,MAAM,wBAAwB,CAAC;AAEhD,MAAM,UAAU,mBAAmB,CACjC,GAAW,EACX,OAAwB,EAAE;IAG1B,IAAI,MAAM,CAAC,SAAS,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC;QACpD,MAAM,IAAI,KAAK,CACb,4FAA4F,CAC7F,CAAC;IACJ,CAAC;IACD,OAAO,QAAQ,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;AAC7B,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,wBAAwB,CAC5C,GAAW,EACX,OAAwB,EAAE;IAG1B,OAAO,mBAAmB,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;AACxC,CAAC","sourcesContent":["// SPDX-License-Identifier: MIT\nimport { execSync, type ExecSyncOptions } from 'node:child_process';\n\nimport { config } from '/config/config.js';\n\nexport function executarShellSeguro(\n  cmd: string,\n  opts: ExecSyncOptions = {},\n): Buffer | string {\n  // only block if SAFE_MODE is explicitly true and ALLOW_EXEC is falsy\n  if (config.SAFE_MODE === true && !config.ALLOW_EXEC) {\n    throw new Error(\n      'Execução de comandos desabilitada em SAFE_MODE. Defina ORACULO_ALLOW_EXEC=1 para permitir.',\n    );\n  }\n  return execSync(cmd, opts);\n}\n\nexport async function executarShellSeguroAsync(\n  cmd: string,\n  opts: ExecSyncOptions = {},\n): Promise<Buffer | string> {\n  // wrapper assíncrono que delega ao sync (usado onde já há await)\n  return executarShellSeguro(cmd, opts);\n}\n"]}