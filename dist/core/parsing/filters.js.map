{"version":3,"file":"filters.js","sourceRoot":"","sources":["../../../src/core/parsing/filters.ts"],"names":[],"mappings":"AAUA,MAAM,UAAU,2BAA2B,CACzC,WAAoD,EACpD,OAAkC;IAElC,IAAI,CAAC,OAAO,EAAE,CAAC;QACb,OAAO,WAA2B,CAAC;IACrC,CAAC;IAED,MAAM,SAAS,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC,UAAU,EAAE,EAAE;QAClD,MAAM,IAAI,GAAI,UAAyB,CAAC,IAAI,IAAI,EAAE,CAAC;QACnD,MAAM,OAAO,GAAG,UAAU,CAAC,OAAO,IAAI,EAAE,CAAC;QACzC,MAAM,KAAK,GAAG,UAAU,CAAC,KAAK,IAAI,EAAE,CAAC;QACrC,MAAM,QAAQ,GAAI,UAAyB,CAAC,QAAQ,IAAI,EAAE,CAAC;QAG3D,IACE,OAAO,CAAC,aAAa,EAAE,IAAI,CACzB,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CACzD,EACD,CAAC;YACD,OAAO,KAAK,CAAC;QACf,CAAC;QAGD,IAAI,OAAO,CAAC,kBAAkB,IAAI,OAAO,CAAC,kBAAkB,CAAC,KAAK,CAAC,EAAE,CAAC;YACpE,OAAO,KAAK,CAAC;QACf,CAAC;QAGD,IACE,OAAO,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE;YAEvC,MAAM,KAAK,GAAG,IAAI,MAAM,CACtB,OAAO,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CACjD,CAAC;YACF,OAAO,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC7B,CAAC,CAAC,EACF,CAAC;YACD,OAAO,KAAK,CAAC;QACf,CAAC;QAGD,IACE,OAAO,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE;YAC9C,MAAM,QAAQ,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,IAAI,EAAE,CAAC;YAChD,MAAM,KAAK,GAAG,IAAI,MAAM,CACtB,OAAO,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CACjD,CAAC;YACF,OAAO,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC9B,CAAC,CAAC,EACF,CAAC;YACD,OAAO,KAAK,CAAC;QACf,CAAC;QAED,OAAO,IAAI,CAAC;IACd,CAAC,CAAC,CAAC;IAEH,OAAO,SAAyB,CAAC;AACnC,CAAC","sourcesContent":["// SPDX-License-Identifier: MIT\nimport type { FiltrosConfig, Ocorrencia, OcorrenciaParseErro } from '@';\n\n// Re-exporta o tipo para compatibilidade\nexport type { FiltrosConfig };\n\n/**\n * Aplica supressão às ocorrências baseado na configuração.\n * IMPORTANTE: Isso é para filtrar SAÍDA/RELATÓRIOS, não varredura de arquivos.\n */\nexport function aplicarSupressaoOcorrencias(\n  ocorrencias: Array<OcorrenciaParseErro | Ocorrencia>,\n  filtros: FiltrosConfig | undefined,\n): Ocorrencia[] {\n  if (!filtros) {\n    return ocorrencias as Ocorrencia[];\n  }\n\n  const filtradas = ocorrencias.filter((ocorrencia) => {\n    const tipo = (ocorrencia as Ocorrencia).tipo || '';\n    const relPath = ocorrencia.relPath || '';\n    const nivel = ocorrencia.nivel || '';\n    const mensagem = (ocorrencia as Ocorrencia).mensagem || '';\n\n    // Suprime por tipo/regra (verifica tanto o tipo quanto a mensagem)\n    if (\n      filtros.suppressRules?.some(\n        (rule) => tipo.includes(rule) || mensagem.includes(rule),\n      )\n    ) {\n      return false;\n    }\n\n    // Suprime por severidade\n    if (filtros.suppressBySeverity && filtros.suppressBySeverity[nivel]) {\n      return false;\n    }\n\n    // Suprime por caminho (glob patterns)\n    if (\n      filtros.suppressByPath?.some((pattern) => {\n        // Implementação simples de glob match\n        const regex = new RegExp(\n          pattern.replace(/\\*/g, '.*').replace(/\\?/g, '.'),\n        );\n        return regex.test(relPath);\n      })\n    ) {\n      return false;\n    }\n\n    // Suprime por padrão de arquivo\n    if (\n      filtros.suppressByFilePattern?.some((pattern) => {\n        const fileName = relPath.split('/').pop() || '';\n        const regex = new RegExp(\n          pattern.replace(/\\*/g, '.*').replace(/\\?/g, '.'),\n        );\n        return regex.test(fileName);\n      })\n    ) {\n      return false;\n    }\n\n    return true;\n  });\n\n  return filtradas as Ocorrencia[];\n}\n"]}