{"version":3,"file":"inquisidor.js","sourceRoot":"","sources":["../../../src/core/execution/inquisidor.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\nimport { promises as fs } from 'node:fs';\n\nimport { registroAnalistas } from '@analistas/registry/registry.js';\nimport { config } from '@core/config/config.js';\nimport { isMetaPath } from '@core/config/paths.js';\nimport { InquisidorMessages } from '@core/messages/core/inquisidor-messages.js';\nimport { log } from '@core/messages/index.js';\nimport { lerEstado } from '@shared/persistence/persistencia.js';\nimport * as path from 'path';\n\nimport type {\n  CacheValor,\n  EstadoIncArquivo,\n  FileEntry,\n  FileEntryWithAst,\n  InquisicaoOptions,\n  MetricasGlobais,\n  OcorrenciaParseErro,\n  ResultadoInquisicaoCompleto,\n  SimbolosLog,\n  Tecnica,\n} from '@';\nimport { ocorrenciaParseErro } from '@';\n\nimport {\n  executarInquisicao as executarExecucao,\n  registrarUltimasMetricas,\n} from './executor.js';\nimport { scanRepository } from './scanner.js';\n// Fallback de s√≠mbolos para cen√°rios de teste onde o mock de log n√£o inclui `simbolos`.\nconst SIMBOLOS_FALLBACK: SimbolosLog = {\n  info: '‚ÑπÔ∏è',\n  sucesso: '‚úÖ',\n  erro: '‚ùå',\n  aviso: '‚ö†Ô∏è',\n  debug: 'üêû',\n  fase: 'üî∂',\n  passo: '‚ñ´Ô∏è',\n  scan: 'üîç',\n  guardian: 'üõ°Ô∏è',\n  pasta: 'üìÇ',\n};\nconst S: SimbolosLog =\n  typeof (log as unknown as { simbolos?: SimbolosLog }).simbolos === 'object'\n    ? (log as unknown as { simbolos: SimbolosLog }).simbolos\n    : SIMBOLOS_FALLBACK;\n// Fallback seguro para infoDestaque quando mocks de teste n√£o exp√µem o m√©todo\nconst __infoDestaque = (mensagem: string) => {\n  const l = log as unknown as {\n    infoDestaque?: (m: string) => void;\n    info: (m: string) => void;\n  };\n  if (typeof l.infoDestaque === 'function') return l.infoDestaque(mensagem);\n  return l.info(mensagem);\n};\n\n// Extens√µes consideradas para tentativa de AST. Observa√ß√µes:\n// - .d.ts √© propositalmente exclu√≠da pelo parser (retorna null) e aqui n√£o entra.\n// - .map (source maps) n√£o deve ser parseado ‚Äì marcamos como N√ÉO pertencente ao conjunto.\nconst EXTENSOES_COM_AST = new Set(\n  Array.isArray(config.SCANNER_EXTENSOES_COM_AST)\n    ? config.SCANNER_EXTENSOES_COM_AST\n    : ['.js', '.jsx', '.ts', '.tsx', '.mjs', '.cjs'],\n);\n\nexport const tecnicas: Tecnica[] = registroAnalistas as Tecnica[];\n\nexport async function prepararComAst(\n  entries: FileEntry[],\n  baseDir: string,\n): Promise<FileEntryWithAst[]> {\n  // Cache em mem√≥ria (process-level). Chave: relPath\n  // Guarda: { mtimeMs, size, ast } - tipo importado de @types\n  const globalStore = globalThis as unknown as Record<string, unknown>;\n  const cache: Map<string, CacheValor> =\n    (globalStore.__ORACULO_AST_CACHE__ as Map<string, CacheValor>) || new Map();\n  if (!globalStore.__ORACULO_AST_CACHE__)\n    globalStore.__ORACULO_AST_CACHE__ = cache;\n  const metricas: MetricasGlobais =\n    (globalStore.__ORACULO_METRICAS__ as MetricasGlobais) || {\n      parsingTimeMs: 0,\n      cacheHits: 0,\n      cacheMiss: 0,\n    };\n  // Reset m√©tricas de parsing a cada prepara√ß√£o completa\n  metricas.parsingTimeMs = 0;\n  metricas.cacheHits = 0;\n  metricas.cacheMiss = 0;\n  globalStore.__ORACULO_METRICAS__ = metricas;\n\n  return Promise.all(\n    entries.map(async (entry): Promise<FileEntryWithAst> => {\n      let ast:\n        | import('@babel/traverse').NodePath<import('@babel/types').Node>\n        | undefined = undefined;\n      const ext = path.extname(entry.relPath);\n      const absPath =\n        typeof entry.fullPath === 'string'\n          ? entry.fullPath\n          : path.resolve(baseDir, entry.relPath);\n      let stats: import('node:fs').Stats | undefined;\n      try {\n        stats = await fs.stat(absPath);\n      } catch {\n        stats = undefined;\n      }\n\n      // Detec√ß√£o de extens√£o com suporte a sufixos compostos (ex.: .d.ts, .js.map)\n      const nomeLower = entry.relPath.toLowerCase();\n      const extEfetiva = nomeLower.endsWith('.d.ts')\n        ? '.d.ts'\n        : nomeLower.endsWith('.map')\n          ? '.map'\n          : ext;\n\n      if (entry.content && EXTENSOES_COM_AST.has(extEfetiva)) {\n        const chave = entry.relPath;\n        if (config.ANALISE_AST_CACHE_ENABLED && stats) {\n          const anterior = cache.get(chave);\n          if (\n            anterior &&\n            anterior.mtimeMs === stats.mtimeMs &&\n            anterior.size === stats.size\n          ) {\n            // Se o cache tinha AST v√°lida, reutiliza; caso contr√°rio, mant√©m undefined para obrigar tentative parsing novamente.\n            ast = anterior.ast;\n            metricas.cacheHits++;\n          }\n        }\n        try {\n          if (!ast) {\n            const inicioParse = performance.now();\n            // Usa a API decifrarSintaxe esperada pelos testes (com spies)\n            const parsed = await import('@core/parsing/parser.js').then((m) =>\n              m.decifrarSintaxe(entry.content || '', extEfetiva, {\n                relPath: entry.relPath,\n              }),\n            );\n            if (parsed && typeof parsed === 'object') {\n              // Mant√©m ast undefined quando parsed √© objeto vazio (forma inv√°lida)\n              if (\n                Object.keys(parsed as unknown as Record<string, unknown>)\n                  .length > 0\n              ) {\n                // Sentinel convertida para o tipo NodePath via unknown cast ‚Äì suficiente para diferenciar truthy\n                ast = {} as unknown as import('@babel/traverse').NodePath<\n                  import('@babel/types').Node\n                >;\n              }\n            } else if (parsed == null) {\n              // Politica: para arquivos em node_modules, n√£o tratar falha de parsing como erro;\n              // em vez disso, seguimos com um sentinel de AST para permitir analistas que n√£o dependem de AST completa.\n              const inNodeModules = /(^|\\/)node_modules(\\/|\\\\)/.test(\n                entry.relPath,\n              );\n              if (inNodeModules) {\n                ast = {} as unknown as import('@babel/traverse').NodePath<\n                  import('@babel/types').Node\n                >;\n              } else {\n                // Tentar extrair linha/coluna do parser executando uma parse r√°pida\n                // que lan√ßa uma exce√ß√£o com informa√ß√£o de localiza√ß√£o (quando dispon√≠vel).\n                const globalStore2 = globalStore as unknown as Record<\n                  string,\n                  unknown\n                >;\n                const lista =\n                  (globalStore2.__ORACULO_PARSE_ERROS__ as\n                    | OcorrenciaParseErro[]\n                    | undefined) || [];\n                try {\n                  // Importar babel parser diretamente e for√ßar parse para capturar erro com loc\n                  const babel = await import('@babel/parser');\n                  try {\n                    // tentativa intencional para capturar a exce√ß√£o com posi√ß√£o\n                    const parseOpts = {\n                      sourceType: 'unambiguous',\n                      plugins: [\n                        'typescript',\n                        'jsx',\n                        'decorators-legacy',\n                        'classProperties',\n                      ],\n                    };\n                    babel.parse(\n                      entry.content || '',\n                      parseOpts as unknown as import('@babel/parser').ParserOptions,\n                    );\n                    // se por algum motivo n√£o lan√ßar, registra erro gen√©rico\n                    lista.push(\n                      ocorrenciaParseErro({\n                        mensagem: InquisidorMessages.parseAstNaoGerada,\n                        relPath: entry.relPath,\n                        origem: 'parser',\n                      }),\n                    );\n                  } catch (e) {\n                    type ParserErrorLike = {\n                      loc?: { line?: number; column?: number };\n                      message?: string;\n                    };\n                    const err = e as unknown as ParserErrorLike;\n                    const linha =\n                      typeof err.loc?.line === 'number'\n                        ? err.loc.line\n                        : undefined;\n                    const coluna =\n                      typeof err.loc?.column === 'number'\n                        ? err.loc.column\n                        : undefined;\n                    const detalhe =\n                      err && err.message ? String(err.message) : undefined;\n                    lista.push(\n                      ocorrenciaParseErro({\n                        mensagem: InquisidorMessages.parseErro(\n                          detalhe || InquisidorMessages.parseAstNaoGerada,\n                        ),\n                        relPath: entry.relPath,\n                        origem: 'parser',\n                        linha,\n                        coluna,\n                        detalhe,\n                      }),\n                    );\n                  }\n                } catch {\n                  // Se n√£o conseguimos importar/usar o babel parser, fallback para mensagem gen√©rica\n                  lista.push(\n                    ocorrenciaParseErro({\n                      mensagem: InquisidorMessages.parseAstNaoGerada,\n                      relPath: entry.relPath,\n                      origem: 'parser',\n                    }),\n                  );\n                }\n                globalStore2.__ORACULO_PARSE_ERROS__ = lista;\n              }\n            }\n            metricas.parsingTimeMs += performance.now() - inicioParse;\n            metricas.cacheMiss++;\n            if (config.ANALISE_AST_CACHE_ENABLED && stats) {\n              cache.set(entry.relPath, {\n                mtimeMs: stats.mtimeMs,\n                size: stats.size,\n                ast,\n              });\n            }\n          }\n        } catch (e) {\n          const err = e as Error;\n          log.erro(\n            InquisidorMessages.falhaGerarAst(entry.relPath, err.message),\n          );\n          // Registra ocorr√™ncia de parse erro\n          const lista =\n            (globalStore.__ORACULO_PARSE_ERROS__ as\n              | OcorrenciaParseErro[]\n              | undefined) || [];\n          lista.push(\n            ocorrenciaParseErro({\n              mensagem: InquisidorMessages.parseErro(err.message),\n              relPath: entry.relPath,\n              origem: 'parser',\n            }),\n          );\n          globalStore.__ORACULO_PARSE_ERROS__ = lista;\n        }\n      }\n\n      return {\n        ...entry,\n        ast,\n        content: entry.content ?? null,\n        fullPath:\n          typeof entry.fullPath === 'string'\n            ? entry.fullPath\n            : path.resolve(baseDir, entry.relPath),\n      } as FileEntryWithAst;\n    }),\n  );\n}\n\nexport async function iniciarInquisicao(\n  baseDir: string = process.cwd(),\n  options: InquisicaoOptions = {},\n): Promise<ResultadoInquisicaoCompleto> {\n  const {\n    includeContent = true,\n    incluirMetadados = true,\n    skipExec = false,\n  } = options;\n  log.info(`${S.scan} Iniciando a Inquisi√ß√£o do Or√°culo em: ${baseDir}`);\n\n  const fileMap = await scanRepository(baseDir, {\n    includeContent,\n    onProgress: (msg) => {\n      // S√≥ exibe diret√≥rios e erros, e em formato leg√≠vel por m√°quina/pessoa\n      try {\n        const progressData = JSON.parse(msg);\n        if (progressData.tipo === 'diretorio') {\n          // Atualiza contador e amostra em mem√≥ria, sem emitir logs incrementais.\n          // A pol√≠tica sem√¢ntica correta: n√£o mostrar progresso parcial durante a varredura;\n          // em vez disso, exibimos apenas um resumo final ap√≥s a conclus√£o da varredura.\n          const g = globalThis as unknown as {\n            __ORACULO_DIR_COUNT__?: number;\n            __ORACULO_DIR_SAMPLES__?: string[];\n          };\n          g.__ORACULO_DIR_COUNT__ = (g.__ORACULO_DIR_COUNT__ || 0) + 1;\n          // Armazena primeiros N diret√≥rios como amostra para diagn√≥stico posterior\n          const SAMPLE_MAX = 5;\n          if (!g.__ORACULO_DIR_SAMPLES__) g.__ORACULO_DIR_SAMPLES__ = [];\n          if (g.__ORACULO_DIR_SAMPLES__.length < SAMPLE_MAX) {\n            g.__ORACULO_DIR_SAMPLES__.push(progressData.caminho);\n          }\n          // contador atualizado em g.__ORACULO_DIR_COUNT__ (n√£o usado diretamente aqui)\n          // Em modo verbose original poder√≠amos mostrar mais detalhes, mas por padr√£o\n          // evitamos ru√≠do progressivo. Erros continuam sendo reportados abaixo.\n        } else if (progressData.tipo === 'erro') {\n          log.erro(\n            `Erro ao ${progressData.acao} ${progressData.caminho}: ${progressData.mensagem}`,\n          );\n        }\n      } catch {\n        // fallback para logs antigos\n        if (msg && msg.includes('‚ö†Ô∏è')) log.aviso(msg);\n      }\n    },\n  });\n  let fileEntries: FileEntryWithAst[];\n\n  let entriesBase = Object.values(fileMap);\n  // Filtra arquivos meta com helper central: tudo fora de src/ √© meta por padr√£o\n  const metaSet = new Set(\n    entriesBase.filter((e) => isMetaPath(e.relPath)).map((e) => e.relPath),\n  );\n  // Prioriza√ß√£o (usa estado incremental anterior somente para ordenar)\n  if (\n    config.ANALISE_PRIORIZACAO_ENABLED &&\n    config.ANALISE_INCREMENTAL_STATE_PATH\n  ) {\n    try {\n      type EstadoIncremental = { arquivos: Record<string, EstadoIncArquivo> };\n      const inc = await lerEstado<EstadoIncremental>(\n        config.ANALISE_INCREMENTAL_STATE_PATH,\n      ).catch(() => null);\n      if (inc && inc.arquivos) {\n        const pesos = (config.ANALISE_PRIORIZACAO_PESOS || {\n          duracaoMs: 1,\n          ocorrencias: 2,\n          penalidadeReuso: 0.5,\n        }) as {\n          duracaoMs: number;\n          ocorrencias: number;\n          penalidadeReuso: number;\n        };\n        const scored = entriesBase.map((e) => {\n          const hist = inc.arquivos[e.relPath];\n          if (!hist)\n            return { ...e, __score: 0 } as FileEntry & { __score: number };\n          let dur = 0;\n          let occ = 0;\n          if (hist.analistas) {\n            for (const a of Object.values(hist.analistas)) {\n              dur += a.duracaoMs;\n              occ += a.ocorrencias;\n            }\n          } else {\n            occ = hist.ocorrencias?.length || 0;\n          }\n          const reuso = hist.reaproveitadoCount || 0;\n          const score =\n            dur * pesos.duracaoMs +\n            occ * pesos.ocorrencias -\n            reuso * pesos.penalidadeReuso;\n          return { ...e, __score: score } as FileEntry & { __score: number };\n        });\n        scored.sort(\n          (a, b) =>\n            (b as unknown as { __score: number }).__score -\n            (a as unknown as { __score: number }).__score,\n        );\n        // Reorganiza empurrando meta para o final\n        const prioritarios: (FileEntry & { __score: number })[] = [];\n        const metas: (FileEntry & { __score: number })[] = [];\n        for (const s of scored)\n          (metaSet.has(s.relPath) ? metas : prioritarios).push(s);\n        const reconstituido = [...prioritarios, ...metas];\n        entriesBase = reconstituido as unknown as typeof entriesBase;\n        const somentePrioritarios = reconstituido.filter(\n          (e) => !metaSet.has(e.relPath),\n        );\n        if (config.LOG_ESTRUTURADO) {\n          log.info(\n            JSON.stringify({\n              tipo: 'priorizacao',\n              estrategia: 'historico-incremental',\n              top: somentePrioritarios.slice(0, 10).map((e) => ({\n                arq: e.relPath,\n                score: (e as unknown as { __score: number }).__score,\n              })),\n              metaEmpurrados: metas.length,\n            }),\n          );\n        } else {\n          const exibidos =\n            somentePrioritarios\n              .slice(0, 5)\n              .map((e) => e.relPath)\n              .join(', ') || '‚Äî';\n          log.info(`üßÆ Prioriza√ß√£o aplicada (top 5 sem meta): ${exibidos}`);\n          if (metas.length) {\n            log.info(\n              `   (${S.info} ${metas.length} arquivos meta movidos para o final da fila)`,\n            );\n          }\n        }\n      }\n    } catch (e) {\n      if (config.DEV_MODE)\n        log.erro(`Falha prioriza√ß√£o: ${(e as Error).message}`);\n    }\n  }\n\n  if (incluirMetadados) {\n    fileEntries = await prepararComAst(entriesBase, baseDir);\n  } else {\n    fileEntries = entriesBase.map((entry) => ({\n      ...entry,\n      ast: undefined,\n      fullPath:\n        typeof entry.fullPath === 'string'\n          ? entry.fullPath\n          : path.resolve(baseDir, entry.relPath),\n    }));\n  }\n\n  // Exibe um resumo √∫nico da varredura preliminar, imediatamente antes da an√°lise principal.\n  try {\n    const g = globalThis as unknown as {\n      __ORACULO_DIR_COUNT__?: number;\n      __ORACULO_DIR_SAMPLES__?: string[];\n    };\n    const totalDirs = g.__ORACULO_DIR_COUNT__ || 0;\n    // N√£o exibir caminhos nem moldura ‚Äî apenas resumo simples em texto.\n    const amostra = Array.isArray(g.__ORACULO_DIR_SAMPLES__)\n      ? g.__ORACULO_DIR_SAMPLES__\n      : [];\n    if (config.LOG_ESTRUTURADO) {\n      log.info(\n        JSON.stringify({\n          tipo: 'varredura_preliminar',\n          totalDiretorios: totalDirs,\n          amostraDiretorios: amostra,\n        }),\n      );\n    } else {\n      // Em modo simples, n√£o emite resumo redundante\n      // A mensagem \"‚úÖ Varredura conclu√≠da: X arquivos em Y diret√≥rios\" j√° cobre isso\n    }\n  } catch {\n    /* ignore */\n  }\n\n  // Agora fileEntries √© FileEntryWithAst[]\n  let totalArquivos = fileEntries.length;\n  let ocorrencias: Array<OcorrenciaParseErro | import('@').Ocorrencia> = [];\n  if (!skipExec) {\n    const execRes = await executarExecucao(\n      fileEntries,\n      tecnicas,\n      baseDir,\n      undefined,\n    );\n    totalArquivos = execRes.totalArquivos;\n    ocorrencias = execRes.ocorrencias;\n  }\n\n  // Anexa ocorr√™ncias de parse se existirem\n  const parseErros: OcorrenciaParseErro[] =\n    ((globalThis as unknown as Record<string, unknown>)\n      .__ORACULO_PARSE_ERROS__ as OcorrenciaParseErro[]) || [];\n  if (parseErros.length) {\n    // Armazena contagem original para m√©tricas (usado em sa√≠da JSON)\n    (\n      globalThis as unknown as { __ORACULO_PARSE_ERROS_ORIGINAIS__?: number }\n    ).__ORACULO_PARSE_ERROS_ORIGINAIS__ = parseErros.length;\n    if (config.PARSE_ERRO_AGRUPAR) {\n      const porArquivo: Record<string, OcorrenciaParseErro[]> = {};\n      for (const pe of parseErros) {\n        const k = pe.relPath || '__desconhecido__';\n        (porArquivo[k] = porArquivo[k] || []).push(pe);\n      }\n      for (const [arq, lista] of Object.entries(porArquivo)) {\n        if (lista.length <= (config.PARSE_ERRO_MAX_POR_ARQUIVO || 1)) {\n          ocorrencias.push(...lista);\n        } else {\n          // Consolida em uma √∫nica ocorr√™ncia representativa\n          ocorrencias.push(\n            ocorrenciaParseErro({\n              mensagem: InquisidorMessages.parseErrosAgregados(lista.length),\n              relPath: arq || '',\n              origem: 'parser',\n            }),\n          );\n        }\n      }\n    } else {\n      ocorrencias.push(...parseErros);\n    }\n  }\n\n  if (!skipExec) {\n    log.sucesso(\n      `üîÆ Inquisi√ß√£o conclu√≠da. Total de ocorr√™ncias: ${ocorrencias.length}`,\n    );\n  } else if (!config.COMPACT_MODE) {\n    __infoDestaque(\n      `Varredura conclu√≠da: total de arquivos: ${fileEntries.length}`,\n    );\n  }\n\n  return {\n    totalArquivos,\n    ocorrencias,\n    arquivosAnalisados: fileEntries.map((f) => f.relPath),\n    timestamp: Date.now(),\n    duracaoMs: 0,\n    fileEntries,\n    guardian: undefined,\n  };\n}\n\nexport { executarExecucao as executarInquisicao, registrarUltimasMetricas };\n"]}