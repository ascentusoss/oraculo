{"version":3,"file":"log-engine.js","sourceRoot":"","sources":["../../../../src/core/messages/log/log-engine.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\n/**\n * Engine de logs adaptativos que se ajusta ao contexto do projeto\n * Detecta automaticamente complexidade e adapta verbosidade\n */\n\nimport { config } from '@core/config/config.js';\nimport {\n  LogContextConfig,\n  LogMessages,\n} from '@core/messages/log/log-messages.js';\nimport { ICONES_FEEDBACK } from '@core/messages/ui/icons.js';\nimport { isJsonMode } from '@shared/helpers/json-mode.js';\n\nimport type {\n  FileMap,\n  LogContext,\n  LogData,\n  LogLevel,\n  LogTemplate,\n  ProjetoMetricas,\n} from '@';\n\nclass LogEngineAdaptativo {\n  private static instance: LogEngineAdaptativo;\n  private contextoAtual: LogContext = 'medio';\n  private metricas: ProjetoMetricas | null = null;\n  private isCI: boolean = false;\n\n  static getInstance(): LogEngineAdaptativo {\n    if (!LogEngineAdaptativo.instance) {\n      LogEngineAdaptativo.instance = new LogEngineAdaptativo();\n    }\n    return LogEngineAdaptativo.instance;\n  }\n\n  /**\n   * Detecta automaticamente o contexto do projeto baseado nos arquivos\n   */\n  detectarContexto(fileMap: FileMap): LogContext {\n    this.metricas = this.analisarProjeto(fileMap);\n    this.isCI = this.detectarCI();\n\n    // Prioridade: CI > Complexidade > Padrão\n    if (this.isCI) {\n      this.contextoAtual = 'ci';\n      this.log('debug', LogMessages.contexto.ci_cd, {});\n      return 'ci';\n    }\n\n    const complexidade = this.metricas.estruturaComplexidade;\n    const totalArquivos = this.metricas.totalArquivos;\n    const linguagens = this.metricas.linguagens.length;\n\n    if (totalArquivos < 20 && linguagens <= 2 && !this.metricas.temTestes) {\n      this.contextoAtual = 'simples';\n      this.log('info', LogMessages.contexto.desenvolvedor_novo, {});\n    } else if (\n      totalArquivos > 100 ||\n      linguagens > 3 ||\n      complexidade === 'complexa'\n    ) {\n      this.contextoAtual = 'complexo';\n      this.log('info', LogMessages.contexto.equipe_experiente, {});\n    } else {\n      this.contextoAtual = 'medio';\n    }\n\n    // Log de detecção do projeto\n    this.log('info', LogMessages.projeto.detectado, {\n      tipo: this.contextoAtual,\n      confianca: this.calcularConfianca(),\n    });\n\n    this.log('debug', LogMessages.projeto.estrutura, {\n      arquivos: totalArquivos,\n      linguagens,\n    });\n\n    return this.contextoAtual;\n  }\n\n  /**\n   * Analisa métricas do projeto para determinar complexidade\n   */\n  private analisarProjeto(fileMap: FileMap): ProjetoMetricas {\n    const arquivos = Object.values(fileMap);\n    const totalArquivos = arquivos.length;\n\n    // Detecta linguagens pelos extensions\n    const extensoes = new Set(\n      arquivos\n        .map((f) => f.relPath.split('.').pop()?.toLowerCase())\n        .filter((ext): ext is string => Boolean(ext)),\n    );\n\n    const linguagens = Array.from(extensoes).filter((ext) =>\n      ['js', 'ts', 'jsx', 'tsx', 'html', 'css', 'php', 'py', 'xml'].includes(\n        ext,\n      ),\n    );\n\n    // Detecta estrutura complexa\n    const temSrcFolder = arquivos.some((f) => f.relPath.startsWith('src/'));\n    const temMultiplosDiretorios =\n      new Set(arquivos.map((f) => f.relPath.split('/')[0])).size > 5;\n    const temConfigFiles = arquivos.some((f) =>\n      [\n        'package.json',\n        'tsconfig.json',\n        'webpack.config.js',\n        'vite.config.ts',\n      ].includes(f.relPath.split('/').pop() || ''),\n    );\n\n    let estruturaComplexidade: 'simples' | 'media' | 'complexa' = 'simples';\n    if (totalArquivos > 100 || temMultiplosDiretorios) {\n      estruturaComplexidade = 'complexa';\n    } else if (totalArquivos > 20 || temSrcFolder || temConfigFiles) {\n      estruturaComplexidade = 'media';\n    }\n\n    return {\n      totalArquivos,\n      linguagens,\n      estruturaComplexidade,\n      temCI: arquivos.some(\n        (f) =>\n          f.relPath.includes('.github/') || f.relPath.includes('.gitlab-ci'),\n      ),\n      temTestes: arquivos.some(\n        (f) => f.relPath.includes('test') || f.relPath.includes('spec'),\n      ),\n      temDependencias: arquivos.some(\n        (f) => f.relPath === 'package.json' || f.relPath === 'requirements.txt',\n      ),\n    };\n  }\n\n  /**\n   * Detecta se está rodando em ambiente CI/CD\n   */\n  private detectarCI(): boolean {\n    return !!(\n      process.env.CI ||\n      process.env.GITHUB_ACTIONS ||\n      process.env.GITLAB_CI ||\n      process.env.JENKINS_URL ||\n      config.REPORT_SILENCE_LOGS\n    );\n  }\n\n  /**\n   * Calcula confiança da detecção de contexto\n   */\n  private calcularConfianca(): number {\n    if (!this.metricas) return 50;\n\n    let confianca = 60; // base\n\n    // Fatores que aumentam confiança\n    if (this.metricas.totalArquivos > 0) confianca += 10;\n    if (this.metricas.linguagens.length > 0) confianca += 10;\n    if (this.metricas.temTestes) confianca += 10;\n    if (this.metricas.temDependencias) confianca += 10;\n\n    return Math.min(confianca, 95);\n  }\n\n  /**\n   * Log adaptativo baseado no contexto atual\n   */\n  log(level: LogLevel, template: LogTemplate, data: LogData = {}): void {\n    // Quando --json está ativo, o stdout deve conter APENAS JSON.\n    // Suprimimos logs visuais e mantemos apenas erros no stderr.\n    if (isJsonMode()) {\n      if (level !== 'erro') return;\n      const formattedMessage = this.formatMessage(\n        template,\n        data,\n        LogContextConfig[this.contextoAtual],\n      );\n      console.error(formattedMessage);\n      return;\n    }\n\n    const contextoConfig = LogContextConfig[this.contextoAtual];\n\n    // Em CI, usar formato estruturado\n    if (this.isCI && this.contextoAtual === 'ci') {\n      this.logEstruturado(level, template, data);\n      return;\n    }\n\n    // Log normal com adaptações\n    const formattedMessage = this.formatMessage(template, data, contextoConfig);\n    const timestamp = this.formatTimestamp();\n\n    const logMethod = this.getLogMethod(level);\n    logMethod(`[${timestamp}] ${formattedMessage}`);\n  }\n\n  /**\n   * Log estruturado para CI/CD\n   */\n  private logEstruturado(\n    level: LogLevel,\n    template: LogTemplate,\n    data: LogData,\n  ): void {\n    const logEntry = {\n      timestamp: new Date().toISOString(),\n      level,\n      message: this.formatMessage(template, data),\n      context: this.contextoAtual,\n      ...data,\n    };\n\n    console.log(JSON.stringify(logEntry));\n  }\n\n  /**\n   * Formata mensagem baseada no contexto\n   */\n  private formatMessage(\n    template: LogTemplate,\n    data: LogData,\n    contextoConfig = LogContextConfig[this.contextoAtual],\n  ): string {\n    const processedData = { ...data };\n\n    // Adapta formato de arquivo baseado no contexto\n    if (processedData.arquivo && typeof processedData.arquivo === 'string') {\n      processedData.arquivo = this.formatarNomeArquivo(\n        processedData.arquivo,\n        contextoConfig.formato_arquivo,\n      );\n    }\n\n    // Aplica formatação de template\n    return template.replace(/\\{(\\w+)\\}/g, (match: string, key: string) => {\n      const value = processedData[key];\n      return value !== undefined ? String(value) : match;\n    });\n  }\n\n  /**\n   * Formata nome do arquivo baseado no contexto\n   */\n  private formatarNomeArquivo(arquivo: string, formato: string): string {\n    switch (formato) {\n      case 'nome_apenas':\n        return arquivo.split('/').pop() || arquivo;\n      case 'relativo':\n        return arquivo.length > 50 ? `...${arquivo.slice(-45)}` : arquivo;\n      case 'completo':\n        return arquivo;\n      default:\n        return arquivo;\n    }\n  }\n\n  private formatTimestamp(): string {\n    const now = new Date();\n    return now.toTimeString().slice(0, 8); // HH:mm:ss\n  }\n\n  private getLogMethod(level: LogLevel) {\n    switch (level) {\n      case 'erro':\n        return console.error;\n      case 'aviso':\n        return console.warn;\n      default:\n        return console.log;\n    }\n  }\n\n  /**\n   * Getters para uso externo\n   */\n  get contexto(): LogContext {\n    return this.contextoAtual;\n  }\n\n  get metricas_projeto(): ProjetoMetricas | null {\n    return this.metricas;\n  }\n\n  /**\n   * Força um contexto específico (para testes ou override manual)\n   */\n  forcarContexto(contexto: LogContext): void {\n    this.contextoAtual = contexto;\n    this.log(\n      'debug',\n      `${ICONES_FEEDBACK.info} Contexto forçado para: ${contexto}`,\n      {},\n    );\n  }\n}\n\nexport const logEngine = LogEngineAdaptativo.getInstance();\nexport { LogEngineAdaptativo };\n"]}